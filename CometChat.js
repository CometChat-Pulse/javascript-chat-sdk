!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=24)}([function(t,e,n){"use strict";e.__esModule=!0;var r=n(5);e.constants={DEFAULT_STORE:"cometchat",MSG_VER_PRE:"store-ver-pre",MSG_VER_POST:"store-ver-post"},function(t){t.Public="public",t.Private="private",t.Protected="protected"}(e.GroupType||(e.GroupType={})),function(t){t.Admin="admin",t.Moderator="moderator",t.Member="member"}(e.GroupMemberScope||(e.GroupMemberScope={})),e.XMPP={host:"encke.cometchat.com",port:7070,bind_url:"/http-bind",deafult_password:"CometChat",jid_string:"[%s]%s@%s/%s",bare_jid_string:"[%s]%s@%s",username_string:"[%s]%s",muc_jid_string:"[%s]%s@%s.%s",xmpp_resource:"cometchat_js_sdk"+(new Date).getTime()},e.LOCAL_STORE={COMMON_STORE:"common_store",USERS_STORE:"users_store",MESSAGES_STORE:"messages_store",STORE_STRING:"%s:%s"},e.ResponseConstants={RESPONSE_KEYS:{KEY_DATA:"data",KEY_ACTION:"action",KEY_MESSAGE:"message",KEY_ERROR:"error",KEY_ERROR_DETAILS:"details",KEY_ERROR_CODE:"code",KEY_ERROR_MESSAGE:"message",KEY_AUTH_TOKEN:"authToken",KEY_WS_CHANNEL:"wsChannel",KEY_IDENTITY:"identity",KEY_SERVICE:"identity",KEY_ENTITIES:"entities",KEY_ENTITITY:"entity",CODE_REQUEST_OK:200,CODE_BAD_REQUEST:401}},e.MessageConstatnts={TYPE:{TEXT:"text",MEDIA:"media",IMAGE:"image",VIDEO:"video",AUDIO:"audio",FILE:"file"},CATEGORY:{MESSAGE:"message",ACTION:"action",CALL:"call"},RECEIVER_TYPE:{USER:"user",GROUP:"group"},KEYS:{ACTION:"action",TYPE:"type",DATA:"data",ID:"id",MUID:"muid",SENDER:"sender",RECEIVER:"receiver",CATEGORY:"category",RECEIVER_TYPE:"receiverType",SENT_AT:"sentAt",STATUS:"status",TEXT:"text",URL:"url"},PAGINATION:{AFFIX:{APPEND:"append",PREPEND:"prepend"},CURSOR_FILEDS:{ID:"id",SEND_AT:"sentAt"},CURSOR_AFFIX_DEFAULT:"prepend",CURSOR_FIELD_DEFAULT:"sentAt",KEYS:{PER_PAGE:"per_page",CURSOR_AFFIX:"cursorAffix",CURSOR_FIELD:"cursorField",CURSOR_VALUE:"cursorValue"}}},function(t){t.ACTION="action",t.MESSAGE="message",t.CALL="call"}(e.MessageCategory||(e.MessageCategory={})),e.ActionConstatnts={ACTION_SUBJECTS:{ACTION_ON:"on",ACTION_BY:"by",ACTION_FOR:"for"},ACTION_ENTITY_TYPE:{GROUP_USER:"groupuser",USER:"user",GROUP:"group"},ACTION_KEYS:{ACTION_CREATED:"created",ACTION_UPDATED:"updated",ACTION_DELETED:"deleted",ENTITY:"entity",ENTITY_TYPE:"entityType",TYPE_MEMBER_JOINED:"joined",TYPE_MEMBER_LEFT:"left",TYPE_MEMBER_KICKED:"kicked",TYPE_MEMBER_OUTCASTED:"outcasted",TYPE_MEMBER_REINSTATED:"reinstated",TYPE_MEMBER_INVITED:"invited",ACTION_SCOPE_CHANGED:"scopeChanged",ACTION_TYPE_USER:"user",ACTION_TYPE_GROUP:"group",ACTION_TYPE_GROUP_MEMBER:"groupMember",ACTION_TYPE_CALL:"call"},ActionMessages:{ACTION_GROUP_JOINED_MESSAGE:"%s joined %s",ACTION_GROUP_LEFT_MESSAGE:"%s left %s",ACTION_MEMBER_KICKED_MESSAGE:"%s kicked %s from %s",ACTION_MEMBER_OUTCASTED_MESSAGE:"%s outcasted %s from %s",ACTION_MEMBER_REINSTATED_MESSAGE:"%s outcasted %s from %s",ACTION_MEMBER_INVITED_MESSAGE:"%s outcasted %s from %s"},ACTION_TYPE:{TYPE_MEMBER_JOINED:"joined",TYPE_MEMBER_LEFT:"left",TYPE_MEMBER_KICKED:"kicked",TYPE_MEMBER_OUTCASTED:"outcasted",TYPE_MEMBER_REINSTATED:"reinstated",TYPE_MEMBER_INVITED:"invited",TYPE_MEMBER_SCOPE_CHANGED:"scopeChanged"}},e.CallConstants={CALL_TYPE_AUDIO:"audio",CALL_TYPE_VIDEO:"video",CALL_KEYS:{CALL_DATA:"data",CALL_ID:"id",CALL_SESSION_ID:"sessionid",CALL_RECEIVER:"receiver",CALL_SENDER:"sender",CALL_RECEIVER_TYPE:"receiverType",CALL_STATUS:"status",CALL_TYPE:"type",CALL_INITIATED_AT:"initiatedAt",CALL_METADATA:"metadata",CALL_ENTITIES:"entities",CALL_ENTITY_TYPE:"entityType",CALL_ENTITY:"entity",CALL_ENTITY_USER:"user",CALL_ENTITY_GROUP:"group"},CALL_STATUS:{CALL_STATUS_INITIATED:"initiated",CALL_STATUS_ONGOING:"ongoing",CALL_STATUS_UNANSWERED:"unanswered",CALL_STATUS_REJECTED:"rejected",CALL_STATUS_BUSY:"busy",CALL_STATUS_CANCELLED:"cancelled",CALL_STATUS_ENDED:"ended"}},e.GroupConstants={KEYS:{NAME:"name",GUID:"guid",TYPE:"type",PASSWORD:"password",ICON:"icon",DESCRIPTION:"description",OWNER:"owner",METADATA:"metadata",CREATED_AT:"createdAt",UPDATED_AT:"updatedAt",HAS_JOINED:"hasJoined",WS_CHANNEL:"wsChannel"}},e.GroupMemersConstans={UID:"uid",GUID:"guid",USER:"user"},e.UserConstants={UID:"uid",NAME:"name",AUTH_TOKEN:"authToken",AVATAR:"avatar",CREDITS:"credits",EMAIL:"email",LAST_ACTIVE_AT:"lastActiveAt",LINK:"link",META_DATA:"metaData",ROLE:"role",STATUS:"status",STATUS_MESSAGE:"statusMessage",USER_NAME:"user_name"},e.Errors={ERROR_IO_EXCEPTION:"ERROR_IO_EXCEPTION",ERROR_JSON_EXCEPTION:"ERROR_JSON_EXCEPTION",ERROR_PASSWORD_MISSING:"ERROR_PASSWORD_MISSING",ERROR_LIMIT_EXCEEDED:"ERROR_LIMIT_EXCEEDED",ERROR_USER_NOT_LOGGED_IN:"ERROR_USER_NOT_LOGGED_IN",ERROR_INVALID_GUID:"ERROR_INVALID_GUID",ERROR_PASSWORD_MISSING_MESSAGE:"Password is mandatory for a protected group",ERROR_LIMIT_EXCEEDED_MESSAGE:"Limit Exceeded Max limit of %s",ERROR_USER_NOT_LOGGED_IN_MESSAGE:"Please log in to CometChat before calling this method",ERROR_INVALID_GUID_MESSAGE:"Please provide a valid GUID",ERROR_DEFAULT_MESSAGE:"Something went wrong"},e.GroupErrors={NOT_A_GROUP:new r.CustomError({code:"NOT_A_GROUP",message:"Please use group class to construct a new group"})},e.PresenceConstatnts={XMPP_KEYS:{FROM:"from",STATUS:"status",LAST_ACTIVE_AT:"lastActiveAt",TYPE:"type"},STATUS:{ONLINE:"online",OFFLINE:"offline"}}},function(t,e,n){"use strict";e.__esModule=!0,e.isObject=function(t){return t instanceof Object&&t.constructor===Object},e.isTruthy=function(t){return[!0,1,"1","true","TRUE"].includes(t)},e.isFalsy=function(t){return"string"==typeof t&&(t=t.trim()),"object"==typeof t&&0===Object.keys(t).length&&(t=void 0),["",0,"0",!1,null,"null",void 0,"undefined"].includes(t)},e.getOrdinalSuffix=function(t){var e=t%10,n=t%100;return 1==e&&11!=n?t+"st":2==e&&12!=n?t+"nd":3==e&&13!=n?t+"rd":t+"th"},e.format=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t.split("%s").reduce(function(t,n,r){return t+n+(e[r]||"")},"")},e.createUidFromJid=function(t){return t.substring(t.lastIndexOf("]")+1,t.lastIndexOf("@"))}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(19),o=n(1),s=n(5),i=n(4),a=n(3),u=n(6),c=n(7),l=n(18),h=n(15),d=n(14),p=n(13),f=n(10),_=n(21),m=n(0),g=n(11),S=n(22),E=n(23),A=n(12),C=n(34),y=u.XMPPConnectionHelper.getInstance(),T=function(){function t(e){t.appId=e,t.messagesStore=f.MessagesStore.getInstance(),t.localStorage=l.LocalStorage.getInstance(),t.userStore=E.UserStore.getInstance()}return t.init=function(t){return this.getInstance(t)},t.getInstance=function(e){return this.cometChat||(this.cometChat=new t(e)),this.cometChat},t.login=function(){for(var e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return new Promise(function(r,i){return e.localStorage.get("user").then(function(u){if(2!=n.length)return t.authToken=n[0],t.isSecure=!0,e.getMyInfo().then(function(t){console.log("user",t),e.user=new a.Me(t),console.log("me",e.user),e.user.setAuthToken(n[0]),e.setAuthToken(n[0]),e.XMPPLogin(e.user,r,i)},function(t){i(t.error)});t.isSecure=!1,t.apiKey=n[1];var c=n[0];console.log("this is print",{user:u}),null!=u&&u.uid!==n[0]?(console.log("this is nope"),e.user=new a.Me(u),e.setAuthToken(t.user.getAuthToken()),e.XMPPLogin(e.user,r,i)):o.isFalsy(t.authToken)?o.isFalsy(c)||(o.isFalsy(t.apiKey)?i(new s.CustomError({code:"-1",name:"UnAuthorised",message:"No uid provided"})):e.generateAuthToken(c).then(function(n){e.user=new a.Me(n),e.setAuthToken(t.user.getAuthToken()),e.getMyInfo().then(function(n){e.user=new a.Me(n),e.user.setAuthToken(t.authToken),e.setAuthToken(e.user.getAuthToken()),e.XMPPLogin(e.user,r,i)},function(t){i(t)})},function(t){i({status:-1,name:t.error.code,message:"User not present"})})):e.XMPPLogin(e.user,r,i)})})},t.setAuthToken=function(e){t.authToken=e},t.generateAuthToken=function(t){return new Promise(function(e,n){i.makeApiCall("authToken",{uid:t}).then(function(t){e(t.data)}).catch(function(t){n(t)})})},t.getMyInfo=function(){return new Promise(function(t,e){i.makeApiCall("getMyDetails").then(function(e){t(e.data)}).catch(function(t){console.log(t),e(t)})})},t.getUsers=function(){return i.makeApiCall("users")},t.sendMessage=function(t){var e=this;return console.log("sending message",{message:t}),new Promise(function(n,r){if(t instanceof d.TextMessage||t instanceof h.MediaMessage)return i.makeApiCall("sendMessage",{},t,t instanceof h.MediaMessage).then(function(t){e.messagesStore.storeMessages([p.MessageController.trasformJSONMessge(t.data)]),n(p.MessageController.trasformJSONMessge(t.data))},function(t){r(t)});r(new s.CustomError({code:"",name:"NOT A MESSAGE"}))})},t.sendMediaMessage=function(t){var e=this;return new Promise(function(n,r){if(o.isFalsy(t))r(new s.CustomError({message:"not a media message"}));else{if(t instanceof h.MediaMessage)return i.makeApiCall("sendMessage",{},t,!0).then(function(t){e.messagesStore.storeMessages([p.MessageController.trasformJSONMessge(t.data)]),n(p.MessageController.trasformJSONMessge(t.data))},function(t){r(t)});r(new s.CustomError({message:"not a media message"}))}})},t.getMessages=function(){var t=this,e=[];return i.makeApiCall("getMessages",{},{per_page:10}).then(function(n){return n.data.map(function(t){e.push(p.MessageController.trasformJSONMessge(t))}),t.messagesStore.storeMessages(e)})},t.XMPPLogin=function(t,e,n){var r=this;y.XMMPLogin(t.getUid(),t.getWsChannel().secret,function(o){switch(o){case c.Strophe.Status.CONNFAIL:n({status:-1,name:"XMPP_CONNECTION_FAIL",message:"XMPP username/password not correct"});break;case c.Strophe.Status.CONNECTED:r.localStorage.set("user",t),r.messagesStore.get(m.constants.MSG_VER_POST).then(function(t){null==t&&(t=0),p.MessageController.getOfflineHistory(1e3,t)}),e(new a.AppUser(t));break;case c.Strophe.Status.AUTHFAIL:n({status:-1,name:"XMPP_CONNECTION_FAIL",message:"XMPP username/password not correct"})}})},t.getUser=function(e){return new Promise(function(n,r){i.makeApiCall("user",{uid:e}).then(function(e){var r=_.UsersController.trasformJSONUser(e.data),s=[];s.push(o.format(m.XMPP.username_string,t.getAppId(),e.data[m.UserConstants.UID])),u.XMPPConnectionHelper.getInstance().getPresenceInfo(s,function(t){s.map(function(e,o){r.setLastActiveAt(t[o].getLastActiveAt()),r.setStatus(t[o].getStatus()),n(r)})})}).catch(function(t){r(new s.CustomError(t.error))})})},t.createGroup=function(t){return new Promise(function(e,n){t instanceof g.Group||n(m.GroupErrors.NOT_A_GROUP),i.makeApiCall("createGroup",{},t).then(function(n){y.joinMuc(t),e(S.GroupsController.trasformJSONGroup(n.data))},function(t){n(new s.CustomError(t.error))})})},t.getGroup=function(t){return new Promise(function(e,n){i.makeApiCall("getGroup",{guid:t}).then(function(t){e(S.GroupsController.trasformJSONGroup(t.data))},function(t){n(new s.CustomError(t.error))})})},t.joinGroup=function(t,e,n){return new Promise(function(r,a){var u;u=o.isFalsy(n)?new g.Group(t,"name",e):new g.Group(t,"",e,n),i.makeApiCall("joinGroup",u,u).then(function(t){y.joinMuc(u),r(S.GroupsController.trasformJSONGroup(t.data[m.ResponseConstants.RESPONSE_KEYS.KEY_DATA][m.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][m.ActionConstatnts.ACTION_KEYS.ENTITY]))},function(t){a(new s.CustomError(t.error))})})},t.updateGroup=function(t){return new Promise(function(e,n){t instanceof g.Group||n(new s.CustomError({message:"No such Group present"})),i.makeApiCall("updateGroup",t,t).then(function(t){e(S.GroupsController.trasformJSONGroup(t.data))},function(t){n(new s.CustomError(t.error))})})},t.deleteGroup=function(t){return new Promise(function(e,n){i.makeApiCall("deleteGroup",{guid:t}).then(function(t){e(S.GroupsController.trasformJSONGroup(t.data))},function(t){n(new s.CustomError(t.error))})})},t.leaveGroup=function(t){return new Promise(function(e,n){i.makeApiCall("leaveGroup",{guid:t}).then(function(n){y.leaveMuc(t),e(!0)},function(t){n(new s.CustomError(t.error))})})},t.kickGroupMembers=function(t,e){return new Promise(function(n,r){i.makeApiCall("kickGroupMembers",{guid:t,uid:e}).then(function(t){n(!0)},function(t){r(new s.CustomError(t.error))})})},t.changeScopeOfMember=function(t,e,n){return new Promise(function(r,o){i.makeApiCall("changeScopeOfMember",{guid:t,uid:e},{scope:n}).then(function(t){r(!0)},function(t){o(new s.CustomError(t.error))})})},t.banGroupMember=function(t,e,n){return new Promise(function(n,r){i.makeApiCall("banGroupMember",{guid:t,uid:e}).then(function(t){n(!0)},function(t){r(new s.CustomError(t.error))})})},t.unbanGroupMember=function(t,e){return new Promise(function(n,r){i.makeApiCall("unbanGroupMember",{guid:t,uid:e}).then(function(t){n(!0)},function(t){r(new s.CustomError(t.error))})})},t.initiateCall=function(t){return new Promise(function(e,n){i.makeApiCall("createCallSession",{},t).then(function(t){var n=A.Call.callFromJSON(t[m.ResponseConstants.RESPONSE_KEYS.KEY_DATA]);C.CallController.getInstance(n,"",n.getSessionId()).initiateCall(),e(Object.assign(n,t[m.ResponseConstants.RESPONSE_KEYS.KEY_DATA]))},function(t){n(new s.CustomError(t.error))})})},t.joinCall=function(t){return new Promise(function(e,n){var r={};r[m.CallConstants.CALL_KEYS.CALL_STATUS]=m.CallConstants.CALL_STATUS.CALL_STATUS_ONGOING,i.makeApiCall("updateCallSession",{sessionid:t},r).then(function(t){var n=A.Call.callFromJSON(t[m.ResponseConstants.RESPONSE_KEYS.KEY_DATA]);e(Object.assign(n,t[m.ResponseConstants.RESPONSE_KEYS.KEY_DATA]))},function(t){n(new s.CustomError(t.error))})})},t.rejectCall=function(t){return new Promise(function(e,n){var r={};r[m.CallConstants.CALL_KEYS.CALL_STATUS]=m.CallConstants.CALL_STATUS.CALL_STATUS_REJECTED,i.makeApiCall("updateCallSession",{sessionid:t},r).then(function(t){var n=A.Call.callFromJSON(t[m.ResponseConstants.RESPONSE_KEYS.KEY_DATA]);e(Object.assign(n,t[m.ResponseConstants.RESPONSE_KEYS.KEY_DATA]))},function(t){n(new s.CustomError(t.error))})})},t.cancelCall=function(t){return new Promise(function(e,n){var r={};r[m.CallConstants.CALL_KEYS.CALL_STATUS]=m.CallConstants.CALL_STATUS.CALL_STATUS_CANCELLED,i.makeApiCall("updateCallSession",{sessionid:t},r).then(function(t){var n=A.Call.callFromJSON(t[m.ResponseConstants.RESPONSE_KEYS.KEY_DATA]);e(Object.assign(n,t[m.ResponseConstants.RESPONSE_KEYS.KEY_DATA]))},function(t){n(new s.CustomError(t.error))})})},t.sendBusyResponse=function(t){return new Promise(function(e,n){var r={};r[m.CallConstants.CALL_KEYS.CALL_STATUS]=m.CallConstants.CALL_STATUS.CALL_STATUS_BUSY,i.makeApiCall("updateCallSession",{sessionid:t},r).then(function(t){var n=A.Call.callFromJSON(t[m.ResponseConstants.RESPONSE_KEYS.KEY_DATA]);e(Object.assign(n,t[m.ResponseConstants.RESPONSE_KEYS.KEY_DATA]))},function(t){n(new s.CustomError(t.error))})})},t.endCall=function(t){return new Promise(function(e,n){var r={};r[m.CallConstants.CALL_KEYS.CALL_STATUS]=m.CallConstants.CALL_STATUS.CALL_STATUS_ENDED,i.makeApiCall("updateCallSession",{sessionid:t},r).then(function(t){var n=A.Call.callFromJSON(t[m.ResponseConstants.RESPONSE_KEYS.KEY_DATA]);e(Object.assign(n,t[m.ResponseConstants.RESPONSE_KEYS.KEY_DATA]))},function(t){n(new s.CustomError(t.error))})})},t.sendUnansweredResponse=function(t){return new Promise(function(e,n){var r={};r[m.CallConstants.CALL_KEYS.CALL_STATUS]=m.CallConstants.CALL_STATUS.CALL_STATUS_UNANSWERED,i.makeApiCall("updateCallSession",{sessionid:t},r).then(function(t){var n=A.Call.callFromJSON(t[m.ResponseConstants.RESPONSE_KEYS.KEY_DATA]);e(Object.assign(n,t[m.ResponseConstants.RESPONSE_KEYS.KEY_DATA]))},function(t){n(new s.CustomError(t.error))})})},t.startCall=function(t,e){var n=document.createElement("iframe");n.src="https://i.chatforyoursite.com/jitsi-meet/"+t,n.name="frame",n.setAttribute("allow","camera,microphone"),n.setAttribute("width","100%"),n.setAttribute("height","100%"),e.appendChild(n),window.addEventListener("message",function(t){"hangup"==t.data.type&&document.body.removeChild(n)})},t.addMessageEventListner=function(t,e){y.addMessageListner(t,e)},t.removeMessageEventListner=function(t){y.removeMessageListner(t)},t.addPresenceListner=function(t,e,n){y.addPresenceListner(t,e,n)},t.removePreseceListner=function(t){y.removeMessageListner(t)},t.getAppId=function(){return t.appId},t.prototype.getApiKey=function(){return t.apiKey},t.prototype.getAuthToken=function(){return t.authToken},t.endpointFactory=new r.EndpointFactory,t}();e.CometChat=T},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0;var s=function(){function t(t){this.uid=t.uid,this.name=t.name,this.authToken=t.authToken,this.avatar=t.avatar,this.credits=t.credits,this.email=t.email,this.lastActiveAt=t.lastActiveAt,this.link=t.link,this.metadata=t.metadata,this.role=t.role,this.status=t.status,this.statusMessage=t.statusMessage}return t.prototype.getUid=function(){return this.uid},t.prototype.setUid=function(t){this.uid=t},t.prototype.getName=function(){return this.name},t.prototype.setName=function(t){this.name=t},t.prototype.getAuthToken=function(){return this.authToken},t.prototype.setAuthToken=function(t){this.authToken=t},t.prototype.getAvatar=function(){return this.avatar},t.prototype.setAvatar=function(t){this.avatar=t},t.prototype.getCredits=function(){return this.credits},t.prototype.setCredits=function(t){this.credits=t},t.prototype.getEmail=function(){return this.email},t.prototype.setEmail=function(t){this.email=t},t.prototype.getLastActiveAt=function(){return this.lastActiveAt},t.prototype.setLastActiveAt=function(t){this.lastActiveAt=t},t.prototype.getLink=function(){return this.link},t.prototype.setLink=function(t){return this.link=t},t.prototype.getMetadata=function(){return this.metadata},t.prototype.setMetadata=function(t){this.metadata=t},t.prototype.getRole=function(){return this.role},t.prototype.setRole=function(t){this.role=t},t.prototype.getStatus=function(){return this.status},t.prototype.setStatus=function(t){this.status=t},t.prototype.getStatusMessage=function(){return this.statusMessage},t.prototype.setStatusMessage=function(t){this.statusMessage=t},t}();e.AppUser=s;var i=function(t){function e(e){var n=t.call(this,e)||this;return n.wsChannel=e.wsChannel,n}return o(e,t),e.prototype.getWsChannel=function(){return this.wsChannel},e}(s);e.Me=i},function(t,e,n){"use strict";e.__esModule=!0;var r=n(26),o=n(2),s=n(1);function i(t,e,n,r,o){var i;return void 0===t&&(t=""),void 0===e&&(e="GET"),void 0===n&&(n={}),void 0===r&&(r={}),s.isFalsy(n)?n=void 0:("GET"==e&&(t+="?",Object.keys(n).map(function(e){t=t+e+"="+n[e]+"&"}),n=void 0),o&&(i=new FormData(this),Object.keys(n).map(function(t){n[t]instanceof Object&&!(n[t]instanceof File)?i.set(t,JSON.stringify(n[t])):i.set(t,n[t])})),n=JSON.stringify(n)),fetch(t,{method:e,mode:"cors",cache:"no-cache",headers:r,redirect:"follow",referrer:"no-referrer",body:o?i:n})}e.makeApiCall=function(t,e,n,s){void 0===t&&(t=""),void 0===e&&(e={}),void 0===n&&(n={});var a=o.CometChat.getInstance();return new Promise(function(u,c){r.getEndPoint(t,e).then(function(e){var r={appId:o.CometChat.getAppId(),Accept:"application/json"};s||(r["Content-Type"]="application/json"),e.hasOwnProperty("isAdminApi")&&e.isAdminApi?a.getApiKey()?r.apiKey=a.getApiKey():c({error:"An apiKey is need to use the "+t+" api."}):a.getAuthToken()?r.authToken=a.getAuthToken():c({error:"An authToken is need to use the "+t+" api."}),i(e.endpoint,e.method,n,r,s).then(function(t){return t.json()}).then(function(t){t.hasOwnProperty("data")?(t.data.hasOwnProperty("authToken")&&o.CometChat.setAuthToken(t.data.authToken),u(t)):c(t)}).catch(function(t){return c})}).catch(function(t){return c})})},e.makeAdminApiCall=function(t,e,n,s){void 0===t&&(t=""),void 0===e&&(e={}),void 0===n&&(n={});var a=o.CometChat.getInstance();return new Promise(function(u,c){r.getEndPoint(t,e).then(function(e){var r={appId:o.CometChat.getAppId(),Accept:"application/json"};s||(r["Content-Type"]="application/json"),e.hasOwnProperty("isAdminApi")&&e.isAdminApi?a.getApiKey()?r.apiKey=a.getApiKey():c({error:"An apiKey is need to use the "+t+" api."}):a.getAuthToken()?r.authToken=a.getAuthToken():c({error:"An authToken is need to use the "+t+" api."}),i(e.endpoint,e.method,n,r,s).then(function(t){return t.json()}).then(function(t){t.hasOwnProperty("data")?(t.data.hasOwnProperty("authToken")&&o.CometChat.setAuthToken(t.data.authToken),u(t)):c(t)}).catch(function(t){return c})}).catch(function(t){return c})})},e.postData=i},function(t,e,n){"use strict";e.__esModule=!0;var r=function(){return function(t){this.code=t.code,this.name=t.name,this.message=t.message,this.details=t.details}}();e.CustomError=r},function(t,e,n){"use strict";e.__esModule=!0;var r=n(1),o=n(27),s=n(2),i=n(20),a=n(13),u=n(0),c=n(29),l=(n(31),n(32),n(17)),h=n(10),d=n(9),p=n(33),f=n(12),_=function(){function t(){this.messageHandlers=[],this.presenceHandlers=[],this.iqHandlers=[]}return t.getInstance=function(){return null!=this.xMPPConnectionHelper&&null!=this.xMPPConnectionHelper||(this.xMPPConnectionHelper=new t),this.xMPPConnectionHelper},t.prototype.XMPPConnect=function(e){r.isFalsy(e)&&(e=t.XMPP_BIND_URL),this.connection=new o.Strophe.Connection(t.XMPP_BIND_URL)},t.prototype.XMMPLogin=function(e,n,i){var d=this;void 0===n&&(n=u.XMPP.deafult_password),r.isFalsy(this.connection)&&this.XMPPConnect(),this.connection.connected?i(o.Strophe.Status.CONNECTED):this.connection.connect(r.format(u.XMPP.jid_string,s.CometChat.getAppId(),e,t.XMPP_HOST,u.XMPP.xmpp_resource),n,function(t){r.isFalsy(i)||i(t),t==o.Strophe.Status.CONNECTED&&(d.connection.sendPresence(o.$pres().c("priority").t("1").up().c("status").t("online")),d.connection.muc.init(d.connection),d.connection.vcard.init(d.connection),d.connection.muc.join(r.format(u.XMPP.muc_jid_string,s.CometChat.getAppId(),"somegroup","call",u.XMPP.host),d.connection.jid),d.connection.muc.listRooms(s.CometChat.getAppId()+"."+u.XMPP.host,function(t){console.log(t.children[0].children,{status:t});var e=t.getElementsByTagName("item");(e=Array.prototype.slice.call(e)).map(function(t){d.connection.muc.join(t.getAttribute("jid"),d.connection.jid)})}),d.connection.send(o.$iq({from:o.Strophe.getBareJidFromJid(d.connection.jid),id:"enable1",type:"set"}).c("enable",{xmlns:"urn:xmpp:carbons:2"})),d.connection.addHandler(function(t){if(t.getElementsByTagName("x").length>0)console.log("Presence manager Main=>",{presence:t});else{var e=c.PresenceController.transformPresence(t);d.getUsersVCard(e.getUid(),function(t){r.isFalsy(t.getUid())||d.presenceHandlers.map(function(n){if(n)switch(t.setLastActiveAt(e.getLastActiveAt()),e.getStatus()){case u.PresenceConstatnts.STATUS.ONLINE:t.setStatus(u.PresenceConstatnts.STATUS.ONLINE),n._eventHander.onUserOnline(t);break;default:t.setStatus(u.PresenceConstatnts.STATUS.OFFLINE),n._eventHander.onUserOffline(t)}})})}return!0},null,"presence"),d.connection.addHandler(function(t){t.getElementsByTagName("vCard")[0]&&console.log("incoming iq ",t.getElementsByTagName("vCard")[0]);var e=t.getElementsByTagName("presence");return(e=Array.prototype.slice.call(e)).length>0&&d.iqHandlers.map(function(t){t._callback(c.PresenceController.transformPresences(e))}),!0},null,"iq"),d.connection.addHandler(function(t){return console.log("Incoming Method=>",{message:t}),console.log(d.messageHandlers),d.messageHandlers.map(function(e){try{console.log(console.log("Incoming Method=>",{message:t})),t=a.MessageController.trasformXMPPMessage(t),h.MessagesStore.getInstance().storeMessages([t])}catch(t){console.log("Incoming Method=> Inside Event Handler",{e:t})}console.log("this is listner",e._eventHander.onActionReceived);try{e&&(t instanceof l.Action?e._eventHander.onActionReceived(t):t instanceof f.Call?e._eventHander.onCallReceived(t):e._eventHander.onMessageReceived(t))}catch(t){console.log({e:t})}}),!0},null,"message"))})},t.prototype.getPresenceInfo=function(t,e){var n="somename"+(new Date).getTime();this.addIqHandler(n,function(t){e(t)});var r=o.$iq({from:this.connection.jid,id:"CC^COMETCHAT-PRESENCE",type:"get",to:u.XMPP.host}).c("query",{xmlns:"jabber:iq:presencereq",action:"presence"}).t(JSON.stringify(t));this.connection.send(r)},t.prototype.addMessageListner=function(t,e){this.messageHandlers=this.messageHandlers.concat([new i.MessageListner(t,e)])},t.prototype.removeMessageListner=function(t){this.messageHandlers=this.messageHandlers.filter(function(e){return e._name!==t})},t.prototype.addPresenceListner=function(t,e,n){this.presenceHandlers=this.presenceHandlers.concat([new i.PresenceListner(t,n)])},t.prototype.removePresenceListner=function(t){this.presenceHandlers=this.presenceHandlers.filter(function(e){return e._name!==t})},t.prototype.addIqHandler=function(t,e){this.iqHandlers=this.iqHandlers.concat([new i.Listner(t,e)])},t.prototype.removeIqHandler=function(t){this.iqHandlers=this.iqHandlers.filter(function(e){return e._name!==t})},t.prototype.joinMuc=function(t){console.log(r.format(u.XMPP.muc_jid_string,s.CometChat.getAppId(),t.getGuid(),s.CometChat.getAppId(),u.XMPP.host)),console.log(this.connection),this.connection.muc.join(r.format(u.XMPP.muc_jid_string,s.CometChat.getAppId(),t.getGuid(),s.CometChat.getAppId(),u.XMPP.host),this.connection.jid)},t.prototype.leaveMuc=function(t){console.log(r.format(u.XMPP.muc_jid_string,s.CometChat.getAppId(),t,s.CometChat.getAppId(),u.XMPP.host)),this.connection.muc.leave(r.format(u.XMPP.muc_jid_string,s.CometChat.getAppId(),t,s.CometChat.getAppId(),u.XMPP.host),this.connection.jid)},t.prototype.getUsersVCard=function(t,e){console.log("userId:=>"+d.getJidFromUid(t)),this.connection.vcard.get(function(t){e(p.VCardController.transformVCard(t))},d.getJidFromUid(t))},t.prototype.trigerMessageHandler=function(t,e){r.isFalsy(e)?this.messageHandlers.map(function(e){t=a.MessageController.trasformXMPPMessage(t),e._eventHander&&(t instanceof l.Action?e._eventHander.onActionReceived(t):t instanceof f.Call?e._eventHander.onCallReceived(t):e._eventHander.onMessageReceived(t))}):this.messageHandlers[e]._eventHander&&(t instanceof l.Action?this.messageHandlers[e]._eventHander.onActionReceived(t):t instanceof f.Call?this.messageHandlers[e]._eventHander.onCallReceived(t):this.messageHandlers[e]._eventHander.onMessageReceived(t))},t.XMPP_HOST=u.XMPP.host,t.XMPP_PORT=u.XMPP.port,t.xMPPConnectionHelper=new t,t.XMPP_BIND_URL="http://"+t.XMPP_HOST+":"+t.XMPP_PORT+u.XMPP.bind_url,t}();e.XMPPConnectionHelper=_},function(t,e,n){var r;window,r=function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="./src/strophe.js")}({"./src/bosh.js":
/*!*********************!*\
  !*** ./src/bosh.js ***!
  \*********************/
/*! no exports provided */function(t,e,n){"use strict";n.r(e);var r=n(/*! core */"./src/core.js"),o=r.default.Strophe,s=r.default.$build;o.Request=function(t,e,n,r){this.id=++o._requestId,this.xmlData=t,this.data=o.serialize(t),this.origFunc=e,this.func=e,this.rid=n,this.date=NaN,this.sends=r||0,this.abort=!1,this.dead=null,this.age=function(){return this.date?(new Date-this.date)/1e3:0},this.timeDead=function(){return this.dead?(new Date-this.dead)/1e3:0},this.xhr=this._newXHR()},o.Request.prototype={getResponse:function(){var t=null;if(this.xhr.responseXML&&this.xhr.responseXML.documentElement){if("parsererror"===(t=this.xhr.responseXML.documentElement).tagName)throw o.error("invalid response received"),o.error("responseText: "+this.xhr.responseText),o.error("responseXML: "+o.serialize(this.xhr.responseXML)),new Error("parsererror")}else if(this.xhr.responseText){if(o.debug("Got responseText but no responseXML; attempting to parse it with DOMParser..."),!(t=(new DOMParser).parseFromString(this.xhr.responseText,"application/xml").documentElement))throw new Error("Parsing produced null node");if(t.querySelector("parsererror")){o.error("invalid response received: "+t.querySelector("parsererror").textContent),o.error("responseText: "+this.xhr.responseText);var e=new Error;throw e.name=o.ErrorCondition.BAD_FORMAT,e}}return t},_newXHR:function(){var t=null;return window.XMLHttpRequest?(t=new XMLHttpRequest).overrideMimeType&&t.overrideMimeType("text/xml; charset=utf-8"):window.ActiveXObject&&(t=new ActiveXObject("Microsoft.XMLHTTP")),t.onreadystatechange=this.func.bind(null,this),t}},o.Bosh=function(t){this._conn=t,this.rid=Math.floor(4294967295*Math.random()),this.sid=null,this.hold=1,this.wait=60,this.window=5,this.errors=0,this.inactivity=null,this.lastResponseHeaders=null,this._requests=[]},o.Bosh.prototype={strip:null,_buildBody:function(){var t=s("body",{rid:this.rid++,xmlns:o.NS.HTTPBIND});return null!==this.sid&&t.attrs({sid:this.sid}),this._conn.options.keepalive&&this._conn._sessionCachingSupported()&&this._cacheSession(),t},_reset:function(){this.rid=Math.floor(4294967295*Math.random()),this.sid=null,this.errors=0,this._conn._sessionCachingSupported()&&window.sessionStorage.removeItem("strophe-bosh-session"),this._conn.nextValidRid(this.rid)},_connect:function(t,e,n){this.wait=t||this.wait,this.hold=e||this.hold,this.errors=0;var r=this._buildBody().attrs({to:this._conn.domain,"xml:lang":"en",wait:this.wait,hold:this.hold,content:"text/xml; charset=utf-8",ver:"1.6","xmpp:version":"1.0","xmlns:xmpp":o.NS.BOSH});n&&r.attrs({route:n});var s=this._conn._connect_cb;this._requests.push(new o.Request(r.tree(),this._onRequestStateChange.bind(this,s.bind(this._conn)),r.tree().getAttribute("rid"))),this._throttledRequestHandler()},_attach:function(t,e,n,r,s,i,a){this._conn.jid=t,this.sid=e,this.rid=n,this._conn.connect_callback=r,this._conn.domain=o.getDomainFromJid(this._conn.jid),this._conn.authenticated=!0,this._conn.connected=!0,this.wait=s||this.wait,this.hold=i||this.hold,this.window=a||this.window,this._conn._changeConnectStatus(o.Status.ATTACHED,null)},_restore:function(t,e,n,r,s){var i=JSON.parse(window.sessionStorage.getItem("strophe-bosh-session"));if(!(null!=i&&i.rid&&i.sid&&i.jid&&(null==t||o.getBareJidFromJid(i.jid)===o.getBareJidFromJid(t)||null===o.getNodeFromJid(t)&&o.getDomainFromJid(i.jid)===t))){var a=new Error("_restore: no restoreable session.");throw a.name="StropheSessionError",a}this._conn.restored=!0,this._attach(i.jid,i.sid,i.rid,e,n,r,s)},_cacheSession:function(){this._conn.authenticated?this._conn.jid&&this.rid&&this.sid&&window.sessionStorage.setItem("strophe-bosh-session",JSON.stringify({jid:this._conn.jid,rid:this.rid,sid:this.sid})):window.sessionStorage.removeItem("strophe-bosh-session")},_connect_cb:function(t){var e=t.getAttribute("type");if(null!==e&&"terminate"===e){var n=t.getAttribute("condition");o.error("BOSH-Connection failed: "+n);var r=t.getElementsByTagName("conflict");return null!==n?("remote-stream-error"===n&&r.length>0&&(n="conflict"),this._conn._changeConnectStatus(o.Status.CONNFAIL,n)):this._conn._changeConnectStatus(o.Status.CONNFAIL,"unknown"),this._conn._doDisconnect(n),o.Status.CONNFAIL}this.sid||(this.sid=t.getAttribute("sid"));var s=t.getAttribute("requests");s&&(this.window=parseInt(s,10));var i=t.getAttribute("hold");i&&(this.hold=parseInt(i,10));var a=t.getAttribute("wait");a&&(this.wait=parseInt(a,10));var u=t.getAttribute("inactivity");u&&(this.inactivity=parseInt(u,10))},_disconnect:function(t){this._sendTerminate(t)},_doDisconnect:function(){this.sid=null,this.rid=Math.floor(4294967295*Math.random()),this._conn._sessionCachingSupported()&&window.sessionStorage.removeItem("strophe-bosh-session"),this._conn.nextValidRid(this.rid)},_emptyQueue:function(){return 0===this._requests.length},_callProtocolErrorHandlers:function(t){var e=this._getRequestStatus(t),n=this._conn.protocolErrorHandlers.HTTP[e];n&&n.call(this,e)},_hitError:function(t){this.errors++,o.warn("request errored, status: "+t+", number of errors: "+this.errors),this.errors>4&&this._conn._onDisconnectTimeout()},_no_auth_received:function(t){o.warn("Server did not yet offer a supported authentication mechanism. Sending a blank poll request."),t=t?t.bind(this._conn):this._conn._connect_cb.bind(this._conn);var e=this._buildBody();this._requests.push(new o.Request(e.tree(),this._onRequestStateChange.bind(this,t),e.tree().getAttribute("rid"))),this._throttledRequestHandler()},_onDisconnectTimeout:function(){this._abortAllRequests()},_abortAllRequests:function(){for(;this._requests.length>0;){var t=this._requests.pop();t.abort=!0,t.xhr.abort(),t.xhr.onreadystatechange=function(){}}},_onIdle:function(){var t=this._conn._data;if(this._conn.authenticated&&0===this._requests.length&&0===t.length&&!this._conn.disconnecting&&(o.info("no requests during idle cycle, sending blank request"),t.push(null)),!this._conn.paused){if(this._requests.length<2&&t.length>0){for(var e=this._buildBody(),n=0;n<t.length;n++)null!==t[n]&&("restart"===t[n]?e.attrs({to:this._conn.domain,"xml:lang":"en","xmpp:restart":"true","xmlns:xmpp":o.NS.BOSH}):e.cnode(t[n]).up());delete this._conn._data,this._conn._data=[],this._requests.push(new o.Request(e.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),e.tree().getAttribute("rid"))),this._throttledRequestHandler()}if(this._requests.length>0){var r=this._requests[0].age();null!==this._requests[0].dead&&this._requests[0].timeDead()>Math.floor(o.SECONDARY_TIMEOUT*this.wait)&&this._throttledRequestHandler(),r>Math.floor(o.TIMEOUT*this.wait)&&(o.warn("Request "+this._requests[0].id+" timed out, over "+Math.floor(o.TIMEOUT*this.wait)+" seconds since last activity"),this._throttledRequestHandler())}}},_getRequestStatus:function(t,e){var n;if(4===t.xhr.readyState)try{n=t.xhr.status}catch(t){o.error("Caught an error while retrieving a request's status, reqStatus: "+n)}return void 0===n&&(n="number"==typeof e?e:0),n},_onRequestStateChange:function(t,e){if(o.debug("request id "+e.id+"."+e.sends+" state changed to "+e.xhr.readyState),e.abort)e.abort=!1;else if(4===e.xhr.readyState){var n=this._getRequestStatus(e);if(this.lastResponseHeaders=e.xhr.getAllResponseHeaders(),this.disconnecting&&n>=400)return this._hitError(n),void this._callProtocolErrorHandlers(e);var r=n>0&&n<500,s=e.sends>this._conn.maxRetries;if((r||s)&&(this._removeRequest(e),o.debug("request id "+e.id+" should now be removed")),200===n){var i=this._requests[0]===e;(this._requests[1]===e||i&&this._requests.length>0&&this._requests[0].age()>Math.floor(o.SECONDARY_TIMEOUT*this.wait))&&this._restartRequest(0),this._conn.nextValidRid(Number(e.rid)+1),o.debug("request id "+e.id+"."+e.sends+" got 200"),t(e),this.errors=0}else 0===n||n>=400&&n<600||n>=12e3?(o.error("request id "+e.id+"."+e.sends+" error "+n+" happened"),this._hitError(n),this._callProtocolErrorHandlers(e),n>=400&&n<500&&(this._conn._changeConnectStatus(o.Status.DISCONNECTING,null),this._conn._doDisconnect())):o.error("request id "+e.id+"."+e.sends+" error "+n+" happened");r||s?s&&!this._conn.connected&&this._conn._changeConnectStatus(o.Status.CONNFAIL,"giving-up"):this._throttledRequestHandler()}},_processRequest:function(t){var e=this,n=this._requests[t],r=this._getRequestStatus(n,-1);if(n.sends>this._conn.maxRetries)this._conn._onDisconnectTimeout();else{var s=n.age(),i=!isNaN(s)&&s>Math.floor(o.TIMEOUT*this.wait),a=null!==n.dead&&n.timeDead()>Math.floor(o.SECONDARY_TIMEOUT*this.wait),u=4===n.xhr.readyState&&(r<1||r>=500);if((i||a||u)&&(a&&o.error("Request ".concat(this._requests[t].id," timed out (secondary), restarting")),n.abort=!0,n.xhr.abort(),n.xhr.onreadystatechange=function(){},this._requests[t]=new o.Request(n.xmlData,n.origFunc,n.rid,n.sends),n=this._requests[t]),0===n.xhr.readyState){o.debug("request id "+n.id+"."+n.sends+" posting");try{var c=this._conn.options.contentType||"text/xml; charset=utf-8";n.xhr.open("POST",this._conn.service,!this._conn.options.sync),void 0!==n.xhr.setRequestHeader&&n.xhr.setRequestHeader("Content-Type",c),this._conn.options.withCredentials&&(n.xhr.withCredentials=!0)}catch(t){return o.error("XHR open failed: "+t.toString()),this._conn.connected||this._conn._changeConnectStatus(o.Status.CONNFAIL,"bad-service"),void this._conn.disconnect()}var l=function(){if(n.date=new Date,e._conn.options.customHeaders){var t=e._conn.options.customHeaders;for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.xhr.setRequestHeader(r,t[r])}n.xhr.send(n.data)};if(n.sends>1){var h=1e3*Math.min(Math.floor(o.TIMEOUT*this.wait),Math.pow(n.sends,3));setTimeout(function(){l()},h)}else l();n.sends++,this._conn.xmlOutput!==o.Connection.prototype.xmlOutput&&(n.xmlData.nodeName===this.strip&&n.xmlData.childNodes.length?this._conn.xmlOutput(n.xmlData.childNodes[0]):this._conn.xmlOutput(n.xmlData)),this._conn.rawOutput!==o.Connection.prototype.rawOutput&&this._conn.rawOutput(n.data)}else o.debug("_processRequest: "+(0===t?"first":"second")+" request has readyState of "+n.xhr.readyState)}},_removeRequest:function(t){o.debug("removing request");for(var e=this._requests.length-1;e>=0;e--)t===this._requests[e]&&this._requests.splice(e,1);t.xhr.onreadystatechange=function(){},this._throttledRequestHandler()},_restartRequest:function(t){var e=this._requests[t];null===e.dead&&(e.dead=new Date),this._processRequest(t)},_reqToData:function(t){try{return t.getResponse()}catch(t){if("parsererror"!==t.message)throw t;this._conn.disconnect("strophe-parsererror")}},_sendTerminate:function(t){o.info("_sendTerminate was called");var e=this._buildBody().attrs({type:"terminate"});t&&e.cnode(t.tree());var n=new o.Request(e.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),e.tree().getAttribute("rid"));this._requests.push(n),this._throttledRequestHandler()},_send:function(){var t=this;clearTimeout(this._conn._idleTimeout),this._throttledRequestHandler(),this._conn._idleTimeout=setTimeout(function(){return t._conn._onIdle()},100)},_sendRestart:function(){this._throttledRequestHandler(),clearTimeout(this._conn._idleTimeout)},_throttledRequestHandler:function(){this._requests?o.debug("_throttledRequestHandler called with "+this._requests.length+" requests"):o.debug("_throttledRequestHandler called with undefined requests"),this._requests&&0!==this._requests.length&&(this._requests.length>0&&this._processRequest(0),this._requests.length>1&&Math.abs(this._requests[0].rid-this._requests[1].rid)<this.window&&this._processRequest(1))}}},"./src/core.js":
/*!*********************!*\
  !*** ./src/core.js ***!
  \*********************/
/*! exports provided: default */function(t,e,n){"use strict";n.r(e);var r=n(/*! md5 */"./src/md5.js"),o=n(/*! sha1 */"./src/sha1.js"),s=n(/*! utils */"./src/utils.js");function i(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){return new h.Builder(t,e)}function c(t){return new h.Builder("iq",t)}function l(t){return new h.Builder("presence",t)}var h={VERSION:"1.3.0",NS:{HTTPBIND:"http://jabber.org/protocol/httpbind",BOSH:"urn:xmpp:xbosh",CLIENT:"jabber:client",AUTH:"jabber:iq:auth",ROSTER:"jabber:iq:roster",PROFILE:"jabber:iq:profile",DISCO_INFO:"http://jabber.org/protocol/disco#info",DISCO_ITEMS:"http://jabber.org/protocol/disco#items",MUC:"http://jabber.org/protocol/muc",SASL:"urn:ietf:params:xml:ns:xmpp-sasl",STREAM:"http://etherx.jabber.org/streams",FRAMING:"urn:ietf:params:xml:ns:xmpp-framing",BIND:"urn:ietf:params:xml:ns:xmpp-bind",SESSION:"urn:ietf:params:xml:ns:xmpp-session",VERSION:"jabber:iq:version",STANZAS:"urn:ietf:params:xml:ns:xmpp-stanzas",XHTML_IM:"http://jabber.org/protocol/xhtml-im",XHTML:"http://www.w3.org/1999/xhtml"},XHTML:{tags:["a","blockquote","br","cite","em","img","li","ol","p","span","strong","ul","body"],attributes:{a:["href"],blockquote:["style"],br:[],cite:["style"],em:[],img:["src","alt","style","height","width"],li:["style"],ol:["style"],p:["style"],span:["style"],strong:[],ul:["style"],body:[]},css:["background-color","color","font-family","font-size","font-style","font-weight","margin-left","margin-right","text-align","text-decoration"],validTag:function(t){for(var e=0;e<h.XHTML.tags.length;e++)if(t===h.XHTML.tags[e])return!0;return!1},validAttribute:function(t,e){if(void 0!==h.XHTML.attributes[t]&&h.XHTML.attributes[t].length>0)for(var n=0;n<h.XHTML.attributes[t].length;n++)if(e===h.XHTML.attributes[t][n])return!0;return!1},validCSS:function(t){for(var e=0;e<h.XHTML.css.length;e++)if(t===h.XHTML.css[e])return!0;return!1}},Status:{ERROR:0,CONNECTING:1,CONNFAIL:2,AUTHENTICATING:3,AUTHFAIL:4,CONNECTED:5,DISCONNECTED:6,DISCONNECTING:7,ATTACHED:8,REDIRECT:9,CONNTIMEOUT:10},ErrorCondition:{BAD_FORMAT:"bad-format",CONFLICT:"conflict",MISSING_JID_NODE:"x-strophe-bad-non-anon-jid",NO_AUTH_MECH:"no-auth-mech",UNKNOWN_REASON:"unknown"},LogLevel:{DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},ElementType:{NORMAL:1,TEXT:3,CDATA:4,FRAGMENT:11},TIMEOUT:1.1,SECONDARY_TIMEOUT:.1,addNamespace:function(t,e){h.NS[t]=e},forEachChild:function(t,e,n){for(var r=0;r<t.childNodes.length;r++){var o=t.childNodes[r];o.nodeType!==h.ElementType.NORMAL||e&&!this.isTagEqual(o,e)||n(o)}},isTagEqual:function(t,e){return t.tagName===e},_xmlGenerator:null,_makeGenerator:function(){var t;return void 0===document.implementation.createDocument||document.implementation.createDocument&&document.documentMode&&document.documentMode<10?(t=this._getIEXmlDom()).appendChild(t.createElement("strophe")):t=document.implementation.createDocument("jabber:client","strophe",null),t},xmlGenerator:function(){return h._xmlGenerator||(h._xmlGenerator=h._makeGenerator()),h._xmlGenerator},_getIEXmlDom:function(){for(var t=null,e=["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.5.0","Msxml2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XMLDOM"],n=0;n<e.length&&null===t;n++)try{t=new ActiveXObject(e[n])}catch(e){t=null}return t},xmlElement:function(t){if(!t)return null;for(var e=h.xmlGenerator().createElement(t),n=1;n<arguments.length;n++){var r=arguments[n];if(r)if("string"==typeof r||"number"==typeof r)e.appendChild(h.xmlTextNode(r));else if("object"===a(r)&&"function"==typeof r.sort)for(var o=0;o<r.length;o++){var s=r[o];"object"===a(s)&&"function"==typeof s.sort&&void 0!==s[1]&&null!==s[1]&&e.setAttribute(s[0],s[1])}else if("object"===a(r))for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&void 0!==r[i]&&null!==r[i]&&e.setAttribute(i,r[i])}return e},xmlescape:function(t){return t=(t=(t=(t=(t=t.replace(/\&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/'/g,"&apos;")).replace(/"/g,"&quot;")},xmlunescape:function(t){return t=(t=(t=(t=(t=t.replace(/\&amp;/g,"&")).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&apos;/g,"'")).replace(/&quot;/g,'"')},xmlTextNode:function(t){return h.xmlGenerator().createTextNode(t)},xmlHtmlNode:function(t){var e;DOMParser?e=(new DOMParser).parseFromString(t,"text/xml"):((e=new ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t));return e},getText:function(t){if(!t)return null;var e="";0===t.childNodes.length&&t.nodeType===h.ElementType.TEXT&&(e+=t.nodeValue);for(var n=0;n<t.childNodes.length;n++)t.childNodes[n].nodeType===h.ElementType.TEXT&&(e+=t.childNodes[n].nodeValue);return h.xmlescape(e)},copyElement:function(t){var e;if(t.nodeType===h.ElementType.NORMAL){e=h.xmlElement(t.tagName);for(var n=0;n<t.attributes.length;n++)e.setAttribute(t.attributes[n].nodeName,t.attributes[n].value);for(var r=0;r<t.childNodes.length;r++)e.appendChild(h.copyElement(t.childNodes[r]))}else t.nodeType===h.ElementType.TEXT&&(e=h.xmlGenerator().createTextNode(t.nodeValue));return e},createHtml:function(t){var e;if(t.nodeType===h.ElementType.NORMAL){var n=t.nodeName.toLowerCase();if(h.XHTML.validTag(n))try{e=h.xmlElement(n);for(var r=0;r<h.XHTML.attributes[n].length;r++){var o=h.XHTML.attributes[n][r],s=t.getAttribute(o);if(null!=s&&""!==s&&!1!==s&&0!==s)if("style"===o&&"object"===a(s)&&void 0!==s.cssText&&(s=s.cssText),"style"===o){for(var i=[],u=s.split(";"),c=0;c<u.length;c++){var l=u[c].split(":"),d=l[0].replace(/^\s*/,"").replace(/\s*$/,"").toLowerCase();if(h.XHTML.validCSS(d)){var p=l[1].replace(/^\s*/,"").replace(/\s*$/,"");i.push(d+": "+p)}}i.length>0&&(s=i.join("; "),e.setAttribute(o,s))}else e.setAttribute(o,s)}for(var f=0;f<t.childNodes.length;f++)e.appendChild(h.createHtml(t.childNodes[f]))}catch(t){e=h.xmlTextNode("")}else{e=h.xmlGenerator().createDocumentFragment();for(var _=0;_<t.childNodes.length;_++)e.appendChild(h.createHtml(t.childNodes[_]))}}else if(t.nodeType===h.ElementType.FRAGMENT){e=h.xmlGenerator().createDocumentFragment();for(var m=0;m<t.childNodes.length;m++)e.appendChild(h.createHtml(t.childNodes[m]))}else t.nodeType===h.ElementType.TEXT&&(e=h.xmlTextNode(t.nodeValue));return e},escapeNode:function(t){return"string"!=typeof t?t:t.replace(/^\s+|\s+$/g,"").replace(/\\/g,"\\5c").replace(/ /g,"\\20").replace(/\"/g,"\\22").replace(/\&/g,"\\26").replace(/\'/g,"\\27").replace(/\//g,"\\2f").replace(/:/g,"\\3a").replace(/</g,"\\3c").replace(/>/g,"\\3e").replace(/@/g,"\\40")},unescapeNode:function(t){return"string"!=typeof t?t:t.replace(/\\20/g," ").replace(/\\22/g,'"').replace(/\\26/g,"&").replace(/\\27/g,"'").replace(/\\2f/g,"/").replace(/\\3a/g,":").replace(/\\3c/g,"<").replace(/\\3e/g,">").replace(/\\40/g,"@").replace(/\\5c/g,"\\")},getNodeFromJid:function(t){return t.indexOf("@")<0?null:t.split("@")[0]},getDomainFromJid:function(t){var e=h.getBareJidFromJid(t);if(e.indexOf("@")<0)return e;var n=e.split("@");return n.splice(0,1),n.join("@")},getResourceFromJid:function(t){var e=t.split("/");return e.length<2?null:(e.splice(0,1),e.join("/"))},getBareJidFromJid:function(t){return t?t.split("/")[0]:null},_handleError:function(t){void 0!==t.stack&&h.fatal(t.stack),t.sourceURL?h.fatal("error: "+this.handler+" "+t.sourceURL+":"+t.line+" - "+t.name+": "+t.message):t.fileName?h.fatal("error: "+this.handler+" "+t.fileName+":"+t.lineNumber+" - "+t.name+": "+t.message):h.fatal("error: "+t.message)},log:function(t,e){t===this.LogLevel.FATAL&&"object"===a(window.console)&&"function"==typeof window.console.error&&window.console.error(e)},debug:function(t){this.log(this.LogLevel.DEBUG,t)},info:function(t){this.log(this.LogLevel.INFO,t)},warn:function(t){this.log(this.LogLevel.WARN,t)},error:function(t){this.log(this.LogLevel.ERROR,t)},fatal:function(t){this.log(this.LogLevel.FATAL,t)},serialize:function(t){if(!t)return null;"function"==typeof t.tree&&(t=t.tree());var e=i(Array(t.attributes.length).keys()).map(function(e){return t.attributes[e].nodeName});e.sort();var n=e.reduce(function(e,n){return"".concat(e," ").concat(n,'="').concat(h.xmlescape(t.attributes.getNamedItem(n).value),'"')},"<".concat(t.nodeName));if(t.childNodes.length>0){n+=">";for(var r=0;r<t.childNodes.length;r++){var o=t.childNodes[r];switch(o.nodeType){case h.ElementType.NORMAL:n+=h.serialize(o);break;case h.ElementType.TEXT:n+=h.xmlescape(o.nodeValue);break;case h.ElementType.CDATA:n+="<![CDATA["+o.nodeValue+"]]>"}}n+="</"+t.nodeName+">"}else n+="/>";return n},_requestId:0,_connectionPlugins:{},addConnectionPlugin:function(t,e){h._connectionPlugins[t]=e},Builder:function(t,e){"presence"!==t&&"message"!==t&&"iq"!==t||(e&&!e.xmlns?e.xmlns=h.NS.CLIENT:e||(e={xmlns:h.NS.CLIENT})),this.nodeTree=h.xmlElement(t,e),this.node=this.nodeTree}};h.Builder.prototype={tree:function(){return this.nodeTree},toString:function(){return h.serialize(this.nodeTree)},up:function(){return this.node=this.node.parentNode,this},root:function(){return this.node=this.nodeTree,this},attrs:function(t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(void 0===t[e]?this.node.removeAttribute(e):this.node.setAttribute(e,t[e]));return this},c:function(t,e,n){var r=h.xmlElement(t,e,n);return this.node.appendChild(r),"string"!=typeof n&&"number"!=typeof n&&(this.node=r),this},cnode:function(t){var e,n=h.xmlGenerator();try{e=void 0!==n.importNode}catch(t){e=!1}var r=e?n.importNode(t,!0):h.copyElement(t);return this.node.appendChild(r),this.node=r,this},t:function(t){var e=h.xmlTextNode(t);return this.node.appendChild(e),this},h:function(t){var e=document.createElement("body");e.innerHTML=t;for(var n=h.createHtml(e);n.childNodes.length>0;)this.node.appendChild(n.childNodes[0]);return this}},h.Handler=function(t,e,n,r,o,s,i){this.handler=t,this.ns=e,this.name=n,this.type=r,this.id=o,this.options=i||{matchBareFromJid:!1,ignoreNamespaceFragment:!1},this.options.matchBare&&(h.warn('The "matchBare" option is deprecated, use "matchBareFromJid" instead.'),this.options.matchBareFromJid=this.options.matchBare,delete this.options.matchBare),this.options.matchBareFromJid?this.from=s?h.getBareJidFromJid(s):null:this.from=s,this.user=!0},h.Handler.prototype={getNamespace:function(t){var e=t.getAttribute("xmlns");return e&&this.options.ignoreNamespaceFragment&&(e=e.split("#")[0]),e},namespaceMatch:function(t){var e=this,n=!1;return!this.ns||(h.forEachChild(t,null,function(t){e.getNamespace(t)===e.ns&&(n=!0)}),n||this.getNamespace(t)===this.ns)},isMatch:function(t){var e=t.getAttribute("from");this.options.matchBareFromJid&&(e=h.getBareJidFromJid(e));var n=t.getAttribute("type");return!(!this.namespaceMatch(t)||this.name&&!h.isTagEqual(t,this.name)||this.type&&(Array.isArray(this.type)?-1===this.type.indexOf(n):n!==this.type)||this.id&&t.getAttribute("id")!==this.id||this.from&&e!==this.from)},run:function(t){var e=null;try{e=this.handler(t)}catch(t){throw h._handleError(t),t}return e},toString:function(){return"{Handler: "+this.handler+"("+this.name+","+this.id+","+this.ns+")}"}},h.TimedHandler=function(t,e){this.period=t,this.handler=e,this.lastCalled=(new Date).getTime(),this.user=!0},h.TimedHandler.prototype={run:function(){return this.lastCalled=(new Date).getTime(),this.handler()},reset:function(){this.lastCalled=(new Date).getTime()},toString:function(){return"{TimedHandler: "+this.handler+"("+this.period+")}"}},h.Connection=function(t,e){var n=this;this.service=t,this.options=e||{};var r=this.options.protocol||"";for(var o in 0===t.indexOf("ws:")||0===t.indexOf("wss:")||0===r.indexOf("ws")?this._proto=new h.Websocket(this):this._proto=new h.Bosh(this),this.jid="",this.domain=null,this.features=null,this._sasl_data={},this.do_session=!1,this.do_bind=!1,this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this.protocolErrorHandlers={HTTP:{},websocket:{}},this._idleTimeout=null,this._disconnectTimeout=null,this.authenticated=!1,this.connected=!1,this.disconnecting=!1,this.do_authentication=!0,this.paused=!1,this.restored=!1,this._data=[],this._uniqueId=0,this._sasl_success_handler=null,this._sasl_failure_handler=null,this._sasl_challenge_handler=null,this.maxRetries=5,this._idleTimeout=setTimeout(function(){return n._onIdle()},100),s.default.addCookies(this.options.cookies),this.registerSASLMechanisms(this.options.mechanisms),h._connectionPlugins)if(Object.prototype.hasOwnProperty.call(h._connectionPlugins,o)){var i=function(){};i.prototype=h._connectionPlugins[o],this[o]=new i,this[o].init(this)}},h.Connection.prototype={reset:function(){this._proto._reset(),this.do_session=!1,this.do_bind=!1,this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this.authenticated=!1,this.connected=!1,this.disconnecting=!1,this.restored=!1,this._data=[],this._requests=[],this._uniqueId=0},pause:function(){this.paused=!0},resume:function(){this.paused=!1},getUniqueId:function(t){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)});return"string"==typeof t||"number"==typeof t?e+":"+t:e+""},addProtocolErrorHandler:function(t,e,n){this.protocolErrorHandlers[t][e]=n},connect:function(t,e,n,r,o,s,i){this.jid=t,this.authzid=h.getBareJidFromJid(this.jid),this.authcid=i||h.getNodeFromJid(this.jid),this.pass=e,this.servtype="xmpp",this.connect_callback=n,this.disconnecting=!1,this.connected=!1,this.authenticated=!1,this.restored=!1,this.domain=h.getDomainFromJid(this.jid),this._changeConnectStatus(h.Status.CONNECTING,null),this._proto._connect(r,o,s)},attach:function(t,e,n,r,o,s,i){if(!(this._proto instanceof h.Bosh)){var a=new Error('The "attach" method can only be used with a BOSH connection.');throw a.name="StropheSessionError",a}this._proto._attach(t,e,n,r,o,s,i)},restore:function(t,e,n,r,o){if(!this._sessionCachingSupported()){var s=new Error('The "restore" method can only be used with a BOSH connection.');throw s.name="StropheSessionError",s}this._proto._restore(t,e,n,r,o)},_sessionCachingSupported:function(){if(this._proto instanceof h.Bosh){if(!JSON)return!1;try{sessionStorage.setItem("_strophe_","_strophe_"),sessionStorage.removeItem("_strophe_")}catch(t){return!1}return!0}return!1},xmlInput:function(t){},xmlOutput:function(t){},rawInput:function(t){},rawOutput:function(t){},nextValidRid:function(t){},send:function(t){if(null!==t){if("function"==typeof t.sort)for(var e=0;e<t.length;e++)this._queueData(t[e]);else"function"==typeof t.tree?this._queueData(t.tree()):this._queueData(t);this._proto._send()}},flush:function(){clearTimeout(this._idleTimeout),this._onIdle()},sendPresence:function(t,e,n,r){var o=this,s=null;"function"==typeof t.tree&&(t=t.tree());var i=t.getAttribute("id");if(i||(i=this.getUniqueId("sendPresence"),t.setAttribute("id",i)),"function"==typeof e||"function"==typeof n){var a=this.addHandler(function(t){s&&o.deleteTimedHandler(s),"error"===t.getAttribute("type")?n&&n(t):e&&e(t)},null,"presence",null,i);r&&(s=this.addTimedHandler(r,function(){return o.deleteHandler(a),n&&n(null),!1}))}return this.send(t),i},sendIQ:function(t,e,n,r){var o=this,s=null;"function"==typeof t.tree&&(t=t.tree());var i=t.getAttribute("id");if(i||(i=this.getUniqueId("sendIQ"),t.setAttribute("id",i)),"function"==typeof e||"function"==typeof n){var a=this.addHandler(function(t){s&&o.deleteTimedHandler(s);var r=t.getAttribute("type");if("result"===r)e&&e(t);else{if("error"!==r){var i=new Error("Got bad IQ type of ".concat(r));throw i.name="StropheError",i}n&&n(t)}},null,"iq",["error","result"],i);r&&(s=this.addTimedHandler(r,function(){return o.deleteHandler(a),n&&n(null),!1}))}return this.send(t),i},_queueData:function(t){if(null===t||!t.tagName||!t.childNodes){var e=new Error("Cannot queue non-DOMElement.");throw e.name="StropheError",e}this._data.push(t)},_sendRestart:function(){var t=this;this._data.push("restart"),this._proto._sendRestart(),this._idleTimeout=setTimeout(function(){return t._onIdle()},100)},addTimedHandler:function(t,e){var n=new h.TimedHandler(t,e);return this.addTimeds.push(n),n},deleteTimedHandler:function(t){this.removeTimeds.push(t)},addHandler:function(t,e,n,r,o,s,i){var a=new h.Handler(t,e,n,r,o,s,i);return this.addHandlers.push(a),a},deleteHandler:function(t){this.removeHandlers.push(t);var e=this.addHandlers.indexOf(t);e>=0&&this.addHandlers.splice(e,1)},registerSASLMechanisms:function(t){this.mechanisms={},(t=t||[h.SASLAnonymous,h.SASLExternal,h.SASLMD5,h.SASLOAuthBearer,h.SASLXOAuth2,h.SASLPlain,h.SASLSHA1]).forEach(this.registerSASLMechanism.bind(this))},registerSASLMechanism:function(t){this.mechanisms[t.prototype.name]=t},disconnect:function(t){if(this._changeConnectStatus(h.Status.DISCONNECTING,t),h.info("Disconnect was called because: "+t),this.connected){var e=!1;this.disconnecting=!0,this.authenticated&&(e=l({xmlns:h.NS.CLIENT,type:"unavailable"})),this._disconnectTimeout=this._addSysTimedHandler(3e3,this._onDisconnectTimeout.bind(this)),this._proto._disconnect(e)}else h.info("Disconnect was called before Strophe connected to the server"),this._proto._abortAllRequests(),this._doDisconnect()},_changeConnectStatus:function(t,e,n){for(var r in h._connectionPlugins)if(Object.prototype.hasOwnProperty.call(h._connectionPlugins,r)){var o=this[r];if(o.statusChanged)try{o.statusChanged(t,e)}catch(t){h.error("".concat(r," plugin caused an exception changing status: ").concat(t))}}if(this.connect_callback)try{this.connect_callback(t,e,n)}catch(t){h._handleError(t),h.error("User connection callback caused an exception: ".concat(t))}},_doDisconnect:function(t){"number"==typeof this._idleTimeout&&clearTimeout(this._idleTimeout),null!==this._disconnectTimeout&&(this.deleteTimedHandler(this._disconnectTimeout),this._disconnectTimeout=null),h.info("_doDisconnect was called"),this._proto._doDisconnect(),this.authenticated=!1,this.disconnecting=!1,this.restored=!1,this.handlers=[],this.timedHandlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this._changeConnectStatus(h.Status.DISCONNECTED,t),this.connected=!1},_dataRecv:function(t,e){var n=this;h.info("_dataRecv called");var r=this._proto._reqToData(t);if(null!==r){for(this.xmlInput!==h.Connection.prototype.xmlInput&&(r.nodeName===this._proto.strip&&r.childNodes.length?this.xmlInput(r.childNodes[0]):this.xmlInput(r)),this.rawInput!==h.Connection.prototype.rawInput&&(e?this.rawInput(e):this.rawInput(h.serialize(r)));this.removeHandlers.length>0;){var o=this.removeHandlers.pop(),s=this.handlers.indexOf(o);s>=0&&this.handlers.splice(s,1)}for(;this.addHandlers.length>0;)this.handlers.push(this.addHandlers.pop());if(this.disconnecting&&this._proto._emptyQueue())this._doDisconnect();else{var i=r.getAttribute("type");if(null!==i&&"terminate"===i){if(this.disconnecting)return;var a=r.getAttribute("condition"),u=r.getElementsByTagName("conflict");return null!==a?("remote-stream-error"===a&&u.length>0&&(a="conflict"),this._changeConnectStatus(h.Status.CONNFAIL,a)):this._changeConnectStatus(h.Status.CONNFAIL,h.ErrorCondition.UNKOWN_REASON),void this._doDisconnect(a)}h.forEachChild(r,null,function(t){var e=n.handlers;n.handlers=[];for(var r=0;r<e.length;r++){var o=e[r];try{!o.isMatch(t)||!n.authenticated&&o.user?n.handlers.push(o):o.run(t)&&n.handlers.push(o)}catch(t){h.warn("Removing Strophe handlers due to uncaught exception: "+t.message)}}})}}},mechanisms:{},_connect_cb:function(t,e,n){var r;h.info("_connect_cb was called"),this.connected=!0;try{r=this._proto._reqToData(t)}catch(t){if(t.name!==h.ErrorCondition.BAD_FORMAT)throw t;this._changeConnectStatus(h.Status.CONNFAIL,h.ErrorCondition.BAD_FORMAT),this._doDisconnect(h.ErrorCondition.BAD_FORMAT)}if(r&&(this.xmlInput!==h.Connection.prototype.xmlInput&&(r.nodeName===this._proto.strip&&r.childNodes.length?this.xmlInput(r.childNodes[0]):this.xmlInput(r)),this.rawInput!==h.Connection.prototype.rawInput&&(n?this.rawInput(n):this.rawInput(h.serialize(r))),this._proto._connect_cb(r)!==h.Status.CONNFAIL))if(r.getElementsByTagNameNS?r.getElementsByTagNameNS(h.NS.STREAM,"features").length>0:r.getElementsByTagName("stream:features").length>0||r.getElementsByTagName("features").length>0){var o=[],s=r.getElementsByTagName("mechanism");if(s.length>0)for(var i=0;i<s.length;i++){var a=h.getText(s[i]);this.mechanisms[a]&&o.push(this.mechanisms[a])}0!==o.length||0!==r.getElementsByTagName("auth").length?!1!==this.do_authentication&&this.authenticate(o):this._proto._no_auth_received(e)}else this._proto._no_auth_received(e)},sortMechanismsByPriority:function(t){for(var e=0;e<t.length-1;++e){for(var n=e,r=e+1;r<t.length;++r)t[r].prototype.priority>t[n].prototype.priority&&(n=r);if(n!==e){var o=t[e];t[e]=t[n],t[n]=o}}return t},_attemptSASLAuth:function(t){t=this.sortMechanismsByPriority(t||[]);for(var e=!1,n=0;n<t.length;++n)if(t[n].prototype.test(this)){this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),this._sasl_challenge_handler=this._addSysHandler(this._sasl_challenge_cb.bind(this),null,"challenge",null,null),this._sasl_mechanism=new t[n],this._sasl_mechanism.onStart(this);var r=u("auth",{xmlns:h.NS.SASL,mechanism:this._sasl_mechanism.name});if(this._sasl_mechanism.isClientFirst){var o=this._sasl_mechanism.onChallenge(this,null);r.t(btoa(o))}this.send(r.tree()),e=!0;break}return e},_attemptLegacyAuth:function(){null===h.getNodeFromJid(this.jid)?(this._changeConnectStatus(h.Status.CONNFAIL,h.ErrorCondition.MISSING_JID_NODE),this.disconnect(h.ErrorCondition.MISSING_JID_NODE)):(this._changeConnectStatus(h.Status.AUTHENTICATING,null),this._addSysHandler(this._auth1_cb.bind(this),null,null,null,"_auth_1"),this.send(c({type:"get",to:this.domain,id:"_auth_1"}).c("query",{xmlns:h.NS.AUTH}).c("username",{}).t(h.getNodeFromJid(this.jid)).tree()))},authenticate:function(t){this._attemptSASLAuth(t)||this._attemptLegacyAuth()},_sasl_challenge_cb:function(t){var e=atob(h.getText(t)),n=this._sasl_mechanism.onChallenge(this,e),r=u("response",{xmlns:h.NS.SASL});return""!==n&&r.t(btoa(n)),this.send(r.tree()),!0},_auth1_cb:function(t){var e=c({type:"set",id:"_auth_2"}).c("query",{xmlns:h.NS.AUTH}).c("username",{}).t(h.getNodeFromJid(this.jid)).up().c("password").t(this.pass);return h.getResourceFromJid(this.jid)||(this.jid=h.getBareJidFromJid(this.jid)+"/strophe"),e.up().c("resource",{}).t(h.getResourceFromJid(this.jid)),this._addSysHandler(this._auth2_cb.bind(this),null,null,null,"_auth_2"),this.send(e.tree()),!1},_sasl_success_cb:function(t){var e=this;if(this._sasl_data["server-signature"]){var n,r=atob(h.getText(t)).match(/([a-z]+)=([^,]+)(,|$)/);if("v"===r[1]&&(n=r[2]),n!==this._sasl_data["server-signature"])return this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_data={},this._sasl_failure_cb(null)}h.info("SASL authentication succeeded."),this._sasl_mechanism&&this._sasl_mechanism.onSuccess(),this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null);var o=[],s=function(t,n){for(;t.length;)e.deleteHandler(t.pop());return e._sasl_auth1_cb(n),!1};return o.push(this._addSysHandler(function(t){return s(o,t)},null,"stream:features",null,null)),o.push(this._addSysHandler(function(t){return s(o,t)},h.NS.STREAM,"features",null,null)),this._sendRestart(),!1},_sasl_auth1_cb:function(t){this.features=t;for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];"bind"===n.nodeName&&(this.do_bind=!0),"session"===n.nodeName&&(this.do_session=!0)}if(!this.do_bind)return this._changeConnectStatus(h.Status.AUTHFAIL,null),!1;this._addSysHandler(this._sasl_bind_cb.bind(this),null,null,null,"_bind_auth_2");var r=h.getResourceFromJid(this.jid);return r?this.send(c({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:h.NS.BIND}).c("resource",{}).t(r).tree()):this.send(c({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:h.NS.BIND}).tree()),!1},_sasl_bind_cb:function(t){var e;if("error"===t.getAttribute("type"))return h.info("SASL binding failed."),t.getElementsByTagName("conflict").length>0&&(e=h.ErrorCondition.CONFLICT),this._changeConnectStatus(h.Status.AUTHFAIL,e,t),!1;var n=t.getElementsByTagName("bind");if(!(n.length>0))return h.info("SASL binding failed."),this._changeConnectStatus(h.Status.AUTHFAIL,null,t),!1;var r=n[0].getElementsByTagName("jid");r.length>0&&(this.jid=h.getText(r[0]),this.do_session?(this._addSysHandler(this._sasl_session_cb.bind(this),null,null,null,"_session_auth_2"),this.send(c({type:"set",id:"_session_auth_2"}).c("session",{xmlns:h.NS.SESSION}).tree())):(this.authenticated=!0,this._changeConnectStatus(h.Status.CONNECTED,null)))},_sasl_session_cb:function(t){if("result"===t.getAttribute("type"))this.authenticated=!0,this._changeConnectStatus(h.Status.CONNECTED,null);else if("error"===t.getAttribute("type"))return h.info("Session creation failed."),this._changeConnectStatus(h.Status.AUTHFAIL,null,t),!1;return!1},_sasl_failure_cb:function(t){return this._sasl_success_handler&&(this.deleteHandler(this._sasl_success_handler),this._sasl_success_handler=null),this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_mechanism&&this._sasl_mechanism.onFailure(),this._changeConnectStatus(h.Status.AUTHFAIL,null,t),!1},_auth2_cb:function(t){return"result"===t.getAttribute("type")?(this.authenticated=!0,this._changeConnectStatus(h.Status.CONNECTED,null)):"error"===t.getAttribute("type")&&(this._changeConnectStatus(h.Status.AUTHFAIL,null,t),this.disconnect("authentication failed")),!1},_addSysTimedHandler:function(t,e){var n=new h.TimedHandler(t,e);return n.user=!1,this.addTimeds.push(n),n},_addSysHandler:function(t,e,n,r,o){var s=new h.Handler(t,e,n,r,o);return s.user=!1,this.addHandlers.push(s),s},_onDisconnectTimeout:function(){return h.info("_onDisconnectTimeout was called"),this._changeConnectStatus(h.Status.CONNTIMEOUT,null),this._proto._onDisconnectTimeout(),this._doDisconnect(),!1},_onIdle:function(){for(var t=this;this.addTimeds.length>0;)this.timedHandlers.push(this.addTimeds.pop());for(;this.removeTimeds.length>0;){var e=this.removeTimeds.pop(),n=this.timedHandlers.indexOf(e);n>=0&&this.timedHandlers.splice(n,1)}for(var r=(new Date).getTime(),o=[],s=0;s<this.timedHandlers.length;s++){var i=this.timedHandlers[s];if(this.authenticated||!i.user)i.lastCalled+i.period-r<=0?i.run()&&o.push(i):o.push(i)}this.timedHandlers=o,clearTimeout(this._idleTimeout),this._proto._onIdle(),this.connected&&(this._idleTimeout=setTimeout(function(){return t._onIdle()},100))}},h.SASLMechanism=function(t,e,n){this.name=t,this.isClientFirst=e,this.priority=n},h.SASLMechanism.prototype={test:function(t){return!0},onStart:function(t){this._connection=t},onChallenge:function(t,e){throw new Error("You should implement challenge handling!")},onFailure:function(){this._connection=null},onSuccess:function(){this._connection=null}},h.SASLAnonymous=function(){},h.SASLAnonymous.prototype=new h.SASLMechanism("ANONYMOUS",!1,20),h.SASLAnonymous.prototype.test=function(t){return null===t.authcid},h.SASLPlain=function(){},h.SASLPlain.prototype=new h.SASLMechanism("PLAIN",!0,50),h.SASLPlain.prototype.test=function(t){return null!==t.authcid},h.SASLPlain.prototype.onChallenge=function(t){var e=t.authzid;return e+="\0",e+=t.authcid,e+="\0",e+=t.pass,s.default.utf16to8(e)},h.SASLSHA1=function(){},h.SASLSHA1.prototype=new h.SASLMechanism("SCRAM-SHA-1",!0,70),h.SASLSHA1.prototype.test=function(t){return null!==t.authcid},h.SASLSHA1.prototype.onChallenge=function(t,e,n){var i=n||r.default.hexdigest(1234567890*Math.random()),a="n="+s.default.utf16to8(t.authcid);return a+=",r=",a+=i,t._sasl_data.cnonce=i,t._sasl_data["client-first-message-bare"]=a,a="n,,"+a,this.onChallenge=function(t,e){for(var n,r,i,a,u,c,l,h,d="c=biws,",p="".concat(t._sasl_data["client-first-message-bare"],",").concat(e,","),f=t._sasl_data.cnonce,_=/([a-z]+)=([^,]+)(,|$)/;e.match(_);){var m=e.match(_);switch(e=e.replace(m[0],""),m[1]){case"r":n=m[2];break;case"s":r=m[2];break;case"i":i=m[2]}}if(n.substr(0,f.length)!==f)return t._sasl_data={},t._sasl_failure_cb();p+=d+="r="+n,r=atob(r),r+="\0\0\0";var g=s.default.utf16to8(t.pass);for(a=c=o.default.core_hmac_sha1(g,r),l=1;l<i;l++){for(u=o.default.core_hmac_sha1(g,o.default.binb2str(c)),h=0;h<5;h++)a[h]^=u[h];c=u}a=o.default.binb2str(a);var S=o.default.core_hmac_sha1(a,"Client Key"),E=o.default.str_hmac_sha1(a,"Server Key"),A=o.default.core_hmac_sha1(o.default.str_sha1(o.default.binb2str(S)),p);for(t._sasl_data["server-signature"]=o.default.b64_hmac_sha1(E,p),h=0;h<5;h++)S[h]^=A[h];return d+=",p="+btoa(o.default.binb2str(S))},a},h.SASLMD5=function(){},h.SASLMD5.prototype=new h.SASLMechanism("DIGEST-MD5",!1,60),h.SASLMD5.prototype.test=function(t){return null!==t.authcid},h.SASLMD5.prototype._quote=function(t){return'"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'},h.SASLMD5.prototype.onChallenge=function(t,e,n){for(var o=/([a-z]+)=("[^"]+"|[^,"]+)(?:,|$)/,i=n||r.default.hexdigest(""+1234567890*Math.random()),a="",u=null,c="";e.match(o);){var l=e.match(o);switch(e=e.replace(l[0],""),l[2]=l[2].replace(/^"(.+)"$/,"$1"),l[1]){case"realm":a=l[2];break;case"nonce":c=l[2];break;case"qop":l[2];break;case"host":u=l[2]}}var h=t.servtype+"/"+t.domain;null!==u&&(h=h+"/"+u);var d=s.default.utf16to8(t.authcid+":"+a+":"+this._connection.pass),p=r.default.hash(d)+":"+c+":"+i,f="AUTHENTICATE:"+h,_="";return _+="charset=utf-8,",_+="username="+this._quote(s.default.utf16to8(t.authcid))+",",_+="realm="+this._quote(a)+",",_+="nonce="+this._quote(c)+",",_+="nc=00000001,",_+="cnonce="+this._quote(i)+",",_+="digest-uri="+this._quote(h)+",",_+="response="+r.default.hexdigest(r.default.hexdigest(p)+":"+c+":00000001:"+i+":auth:"+r.default.hexdigest(f))+",",_+="qop=auth",this.onChallenge=function(){return""},_},h.SASLOAuthBearer=function(){},h.SASLOAuthBearer.prototype=new h.SASLMechanism("OAUTHBEARER",!0,40),h.SASLOAuthBearer.prototype.test=function(t){return null!==t.pass},h.SASLOAuthBearer.prototype.onChallenge=function(t){var e="n,";return null!==t.authcid&&(e=e+"a="+t.authzid),e+=",",e+="",e+="auth=Bearer ",e+=t.pass,e+="",e+="",s.default.utf16to8(e)},h.SASLExternal=function(){},h.SASLExternal.prototype=new h.SASLMechanism("EXTERNAL",!0,10),h.SASLExternal.prototype.onChallenge=function(t){return t.authcid===t.authzid?"":t.authzid},h.SASLXOAuth2=function(){},h.SASLXOAuth2.prototype=new h.SASLMechanism("X-OAUTH2",!0,30),h.SASLXOAuth2.prototype.test=function(t){return null!==t.pass},h.SASLXOAuth2.prototype.onChallenge=function(t){var e="\0";return null!==t.authcid&&(e+=t.authzid),e+="\0",e+=t.pass,s.default.utf16to8(e)},e.default={Strophe:h,$build:u,$iq:c,$msg:function(t){return new h.Builder("message",t)},$pres:l,SHA1:o.default,MD5:r.default,b64_hmac_sha1:o.default.b64_hmac_sha1,b64_sha1:o.default.b64_sha1,str_hmac_sha1:o.default.str_hmac_sha1,str_sha1:o.default.str_sha1}},"./src/md5.js":
/*!********************!*\
  !*** ./src/md5.js ***!
  \********************/
/*! exports provided: default */function(t,e,n){"use strict";n.r(e),n.d(e,"default",function(){return h});var r=function(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n},o=function(t){for(var e=[],n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<n%32;return e},s=function(t,e,n,o,s,i){return r((a=r(r(e,t),r(o,i)))<<(u=s)|a>>>32-u,n);var a,u},i=function(t,e,n,r,o,i,a){return s(e&n|~e&r,t,e,o,i,a)},a=function(t,e,n,r,o,i,a){return s(e&r|n&~r,t,e,o,i,a)},u=function(t,e,n,r,o,i,a){return s(e^n^r,t,e,o,i,a)},c=function(t,e,n,r,o,i,a){return s(n^(e|~r),t,e,o,i,a)},l=function(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var n,o,s,l,h=1732584193,d=-271733879,p=-1732584194,f=271733878,_=0;_<t.length;_+=16)n=h,o=d,s=p,l=f,h=i(h,d,p,f,t[_+0],7,-680876936),f=i(f,h,d,p,t[_+1],12,-389564586),p=i(p,f,h,d,t[_+2],17,606105819),d=i(d,p,f,h,t[_+3],22,-1044525330),h=i(h,d,p,f,t[_+4],7,-176418897),f=i(f,h,d,p,t[_+5],12,1200080426),p=i(p,f,h,d,t[_+6],17,-1473231341),d=i(d,p,f,h,t[_+7],22,-45705983),h=i(h,d,p,f,t[_+8],7,1770035416),f=i(f,h,d,p,t[_+9],12,-1958414417),p=i(p,f,h,d,t[_+10],17,-42063),d=i(d,p,f,h,t[_+11],22,-1990404162),h=i(h,d,p,f,t[_+12],7,1804603682),f=i(f,h,d,p,t[_+13],12,-40341101),p=i(p,f,h,d,t[_+14],17,-1502002290),d=i(d,p,f,h,t[_+15],22,1236535329),h=a(h,d,p,f,t[_+1],5,-165796510),f=a(f,h,d,p,t[_+6],9,-1069501632),p=a(p,f,h,d,t[_+11],14,643717713),d=a(d,p,f,h,t[_+0],20,-373897302),h=a(h,d,p,f,t[_+5],5,-701558691),f=a(f,h,d,p,t[_+10],9,38016083),p=a(p,f,h,d,t[_+15],14,-660478335),d=a(d,p,f,h,t[_+4],20,-405537848),h=a(h,d,p,f,t[_+9],5,568446438),f=a(f,h,d,p,t[_+14],9,-1019803690),p=a(p,f,h,d,t[_+3],14,-187363961),d=a(d,p,f,h,t[_+8],20,1163531501),h=a(h,d,p,f,t[_+13],5,-1444681467),f=a(f,h,d,p,t[_+2],9,-51403784),p=a(p,f,h,d,t[_+7],14,1735328473),d=a(d,p,f,h,t[_+12],20,-1926607734),h=u(h,d,p,f,t[_+5],4,-378558),f=u(f,h,d,p,t[_+8],11,-2022574463),p=u(p,f,h,d,t[_+11],16,1839030562),d=u(d,p,f,h,t[_+14],23,-35309556),h=u(h,d,p,f,t[_+1],4,-1530992060),f=u(f,h,d,p,t[_+4],11,1272893353),p=u(p,f,h,d,t[_+7],16,-155497632),d=u(d,p,f,h,t[_+10],23,-1094730640),h=u(h,d,p,f,t[_+13],4,681279174),f=u(f,h,d,p,t[_+0],11,-358537222),p=u(p,f,h,d,t[_+3],16,-722521979),d=u(d,p,f,h,t[_+6],23,76029189),h=u(h,d,p,f,t[_+9],4,-640364487),f=u(f,h,d,p,t[_+12],11,-421815835),p=u(p,f,h,d,t[_+15],16,530742520),d=u(d,p,f,h,t[_+2],23,-995338651),h=c(h,d,p,f,t[_+0],6,-198630844),f=c(f,h,d,p,t[_+7],10,1126891415),p=c(p,f,h,d,t[_+14],15,-1416354905),d=c(d,p,f,h,t[_+5],21,-57434055),h=c(h,d,p,f,t[_+12],6,1700485571),f=c(f,h,d,p,t[_+3],10,-1894986606),p=c(p,f,h,d,t[_+10],15,-1051523),d=c(d,p,f,h,t[_+1],21,-2054922799),h=c(h,d,p,f,t[_+8],6,1873313359),f=c(f,h,d,p,t[_+15],10,-30611744),p=c(p,f,h,d,t[_+6],15,-1560198380),d=c(d,p,f,h,t[_+13],21,1309151649),h=c(h,d,p,f,t[_+4],6,-145523070),f=c(f,h,d,p,t[_+11],10,-1120210379),p=c(p,f,h,d,t[_+2],15,718787259),d=c(d,p,f,h,t[_+9],21,-343485551),h=r(h,n),d=r(d,o),p=r(p,s),f=r(f,l);return[h,d,p,f]},h={hexdigest:function(t){return function(t){for(var e="",n=0;n<4*t.length;n++)e+="0123456789abcdef".charAt(t[n>>2]>>n%4*8+4&15)+"0123456789abcdef".charAt(t[n>>2]>>n%4*8&15);return e}(l(o(t),8*t.length))},hash:function(t){return function(t){for(var e="",n=0;n<32*t.length;n+=8)e+=String.fromCharCode(t[n>>5]>>>n%32&255);return e}(l(o(t),8*t.length))}}},"./src/sha1.js":
/*!*********************!*\
  !*** ./src/sha1.js ***!
  \*********************/
/*! exports provided: default */function(t,e,n){"use strict";function r(t,e){t[e>>5]|=128<<24-e%32,t[15+(e+64>>9<<4)]=e;var n,r,i,c,l,h,d,p,f=new Array(80),_=1732584193,m=-271733879,g=-1732584194,S=271733878,E=-1009589776;for(n=0;n<t.length;n+=16){for(c=_,l=m,h=g,d=S,p=E,r=0;r<80;r++)f[r]=r<16?t[n+r]:u(f[r-3]^f[r-8]^f[r-14]^f[r-16],1),i=a(a(u(_,5),o(r,m,g,S)),a(a(E,f[r]),s(r))),E=S,S=g,g=u(m,30),m=_,_=i;_=a(_,c),m=a(m,l),g=a(g,h),S=a(S,d),E=a(E,p)}return[_,m,g,S,E]}function o(t,e,n,r){return t<20?e&n|~e&r:t<40?e^n^r:t<60?e&n|e&r|n&r:e^n^r}function s(t){return t<20?1518500249:t<40?1859775393:t<60?-1894007588:-899497514}function i(t,e){var n=c(t);n.length>16&&(n=r(n,8*t.length));for(var o=new Array(16),s=new Array(16),i=0;i<16;i++)o[i]=909522486^n[i],s[i]=1549556828^n[i];var a=r(o.concat(c(e)),512+8*e.length);return r(s.concat(a),672)}function a(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function u(t,e){return t<<e|t>>>32-e}function c(t){for(var e=[],n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<24-n%32;return e}function l(t){for(var e,n,r="",o=0;o<4*t.length;o+=3)for(e=(t[o>>2]>>8*(3-o%4)&255)<<16|(t[o+1>>2]>>8*(3-(o+1)%4)&255)<<8|t[o+2>>2]>>8*(3-(o+2)%4)&255,n=0;n<4;n++)8*o+6*n>32*t.length?r+="=":r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>6*(3-n)&63);return r}function h(t){for(var e="",n=0;n<32*t.length;n+=8)e+=String.fromCharCode(t[n>>5]>>>24-n%32&255);return e}n.r(e),n.d(e,"default",function(){return d});var d={b64_hmac_sha1:function(t,e){return l(i(t,e))},b64_sha1:function(t){return l(r(c(t),8*t.length))},binb2str:h,core_hmac_sha1:i,str_hmac_sha1:function(t,e){return h(i(t,e))},str_sha1:function(t){return h(r(c(t),8*t.length))}}},"./src/strophe.js":
/*!************************!*\
  !*** ./src/strophe.js ***!
  \************************/
/*! exports provided: default */function(t,e,n){"use strict";n.r(e);n(/*! bosh */"./src/bosh.js"),n(/*! websocket */"./src/websocket.js");var r=n(/*! core */"./src/core.js");n.d(e,"default",function(){return r.default})},"./src/utils.js":
/*!**********************!*\
  !*** ./src/utils.js ***!
  \**********************/
/*! exports provided: default */function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n.r(e),n.d(e,"default",function(){return o});var o={utf16to8:function(t){var e,n,r="",o=t.length;for(e=0;e<o;e++)(n=t.charCodeAt(e))>=0&&n<=127?r+=t.charAt(e):n>2047?(r+=String.fromCharCode(224|n>>12&15),r+=String.fromCharCode(128|n>>6&63),r+=String.fromCharCode(128|n>>0&63)):(r+=String.fromCharCode(192|n>>6&31),r+=String.fromCharCode(128|n>>0&63));return r},addCookies:function(t){for(var e in t=t||{})if(Object.prototype.hasOwnProperty.call(t,e)){var n="",o="",s="",i=t[e],a="object"===r(i),u=escape(unescape(a?i.value:i));a&&(n=i.expires?";expires="+i.expires:"",o=i.domain?";domain="+i.domain:"",s=i.path?";path="+i.path:""),document.cookie=e+"="+u+n+o+s}}}},"./src/websocket.js":
/*!**************************!*\
  !*** ./src/websocket.js ***!
  \**************************/
/*! no exports provided */function(t,e,n){"use strict";n.r(e);var r=n(/*! core */"./src/core.js"),o=r.default.Strophe,s=r.default.$build;o.Websocket=function(t){this._conn=t,this.strip="wrapper";var e=t.service;if(0!==e.indexOf("ws:")&&0!==e.indexOf("wss:")){var n="";"ws"===t.options.protocol&&"https:"!==window.location.protocol?n+="ws":n+="wss",n+="://"+window.location.host,0!==e.indexOf("/")?n+=window.location.pathname+e:n+=e,t.service=n}},o.Websocket.prototype={_buildStream:function(){return s("open",{xmlns:o.NS.FRAMING,to:this._conn.domain,version:"1.0"})},_check_streamerror:function(t,e){var n;if(0===(n=t.getElementsByTagNameNS?t.getElementsByTagNameNS(o.NS.STREAM,"error"):t.getElementsByTagName("stream:error")).length)return!1;for(var r=n[0],s="",i="",a=0;a<r.childNodes.length;a++){var u=r.childNodes[a];if("urn:ietf:params:xml:ns:xmpp-streams"!==u.getAttribute("xmlns"))break;"text"===u.nodeName?i=u.textContent:s=u.nodeName}var c="WebSocket stream error: ";return c+=s||"unknown",i&&(c+=" - "+i),o.error(c),this._conn._changeConnectStatus(e,s),this._conn._doDisconnect(),!0},_reset:function(){},_connect:function(){this._closeSocket(),this.socket=new WebSocket(this._conn.service,"xmpp"),this.socket.onopen=this._onOpen.bind(this),this.socket.onerror=this._onError.bind(this),this.socket.onclose=this._onClose.bind(this),this.socket.onmessage=this._connect_cb_wrapper.bind(this)},_connect_cb:function(t){if(this._check_streamerror(t,o.Status.CONNFAIL))return o.Status.CONNFAIL},_handleStreamStart:function(t){var e=!1,n=t.getAttribute("xmlns");"string"!=typeof n?e="Missing xmlns in <open />":n!==o.NS.FRAMING&&(e="Wrong xmlns in <open />: "+n);var r=t.getAttribute("version");return"string"!=typeof r?e="Missing version in <open />":"1.0"!==r&&(e="Wrong version in <open />: "+r),!e||(this._conn._changeConnectStatus(o.Status.CONNFAIL,e),this._conn._doDisconnect(),!1)},_connect_cb_wrapper:function(t){if(0===t.data.indexOf("<open ")||0===t.data.indexOf("<?xml")){var e=t.data.replace(/^(<\?.*?\?>\s*)*/,"");if(""===e)return;var n=(new DOMParser).parseFromString(e,"text/xml").documentElement;this._conn.xmlInput(n),this._conn.rawInput(t.data),this._handleStreamStart(n)&&this._connect_cb(n)}else if(0===t.data.indexOf("<close ")){var r=(new DOMParser).parseFromString(t.data,"text/xml").documentElement;this._conn.xmlInput(r),this._conn.rawInput(t.data);var s=r.getAttribute("see-other-uri");if(s){var i=this._conn.service;(i.indexOf("wss:")>=0&&s.indexOf("wss:")>=0||i.indexOf("ws:")>=0)&&(this._conn._changeConnectStatus(o.Status.REDIRECT,"Received see-other-uri, resetting connection"),this._conn.reset(),this._conn.service=s,this._connect())}else this._conn._changeConnectStatus(o.Status.CONNFAIL,"Received closing stream"),this._conn._doDisconnect()}else{var a=this._streamWrap(t.data),u=(new DOMParser).parseFromString(a,"text/xml").documentElement;this.socket.onmessage=this._onMessage.bind(this),this._conn._connect_cb(u,null,t.data)}},_disconnect:function(t){if(this.socket&&this.socket.readyState!==WebSocket.CLOSED){t&&this._conn.send(t);var e=s("close",{xmlns:o.NS.FRAMING});this._conn.xmlOutput(e.tree());var n=o.serialize(e);this._conn.rawOutput(n);try{this.socket.send(n)}catch(t){o.info("Couldn't send <close /> tag.")}}this._conn._doDisconnect()},_doDisconnect:function(){o.info("WebSockets _doDisconnect was called"),this._closeSocket()},_streamWrap:function(t){return"<wrapper>"+t+"</wrapper>"},_closeSocket:function(){if(this.socket)try{this.socket.onerror=null,this.socket.close()}catch(t){o.debug(t.message)}this.socket=null},_emptyQueue:function(){return!0},_onClose:function(t){this._conn.connected&&!this._conn.disconnecting?(o.error("Websocket closed unexpectedly"),this._conn._doDisconnect()):t&&1006===t.code&&!this._conn.connected&&this.socket?(o.error("Websocket closed unexcectedly"),this._conn._changeConnectStatus(o.Status.CONNFAIL,"The WebSocket connection could not be established or was disconnected."),this._conn._doDisconnect()):o.info("Websocket closed")},_no_auth_received:function(t){o.error("Server did not offer a supported authentication mechanism"),this._changeConnectStatus(o.Status.CONNFAIL,o.ErrorCondition.NO_AUTH_MECH),t&&t.call(this._conn),this._conn._doDisconnect()},_onDisconnectTimeout:function(){},_abortAllRequests:function(){},_onError:function(t){o.error("Websocket error "+t),this._conn._changeConnectStatus(o.Status.CONNFAIL,"The WebSocket connection could not be established or was disconnected."),this._disconnect()},_onIdle:function(){var t=this._conn._data;if(t.length>0&&!this._conn.paused){for(var e=0;e<t.length;e++)if(null!==t[e]){var n=void 0;n="restart"===t[e]?this._buildStream().tree():t[e];var r=o.serialize(n);this._conn.xmlOutput(n),this._conn.rawOutput(r),this.socket.send(r)}this._conn._data=[]}},_onMessage:function(t){var e,n='<close xmlns="urn:ietf:params:xml:ns:xmpp-framing" />';if(t.data===n)return this._conn.rawInput(n),this._conn.xmlInput(t),void(this._conn.disconnecting||this._conn._doDisconnect());if(0===t.data.search("<open ")){if(e=(new DOMParser).parseFromString(t.data,"text/xml").documentElement,!this._handleStreamStart(e))return}else{var r=this._streamWrap(t.data);e=(new DOMParser).parseFromString(r,"text/xml").documentElement}return this._check_streamerror(e,o.Status.ERROR)?void 0:this._conn.disconnecting&&"presence"===e.firstChild.nodeName&&"unavailable"===e.firstChild.getAttribute("type")?(this._conn.xmlInput(e),void this._conn.rawInput(o.serialize(e))):void this._conn._dataRecv(e,t.data)},_onOpen:function(){o.info("Websocket open");var t=this._buildStream();this._conn.xmlOutput(t.tree());var e=o.serialize(t);this._conn.rawOutput(e),this.socket.send(e)},_reqToData:function(t){return t},_send:function(){this._conn.flush()},_sendRestart:function(){clearTimeout(this._conn._idleTimeout),this._conn._onIdle.bind(this._conn)()}}}}).default},t.exports=r()},function(t,e,n){"use strict";e.__esModule=!0;var r=function(){function t(t,e,n,r){this.receiver=t,this.type=e,this.receiverType=n,this.category=r}return t.prototype.getId=function(){return this.id},t.prototype.setId=function(t){this.id=t},t.prototype.getMuid=function(){return this.muid},t.prototype.setMuid=function(t){this.muid=t},t.prototype.getSender=function(){return this.sender},t.prototype.setSender=function(t){this.sender=t},t.prototype.getReceiver=function(){return this.receiver},t.prototype.setReceiver=function(t){this.receiver=t},t.prototype.getType=function(){return this.type},t.prototype.setType=function(t){this.type=t},t.prototype.get=function(){return this.id},t.prototype.setReceiverType=function(t){this.receiverType=t},t.prototype.getReceiverType=function(){return this.receiverType},t.prototype.setSentAt=function(t){this.sentAt=t},t.prototype.getSentAt=function(){return this.sentAt},t.prototype.getStatus=function(){return this.status},t.prototype.setStatus=function(t){this.status=t},t}();e.BaseMessage=r},function(t,e,n){"use strict";e.__esModule=!0;var r=n(0),o=n(1),s=n(2);e.getUidFromJid=function(t){return t.substring(t.lastIndexOf("]")+1,t.lastIndexOf("@"))},e.getappIdFromJid=function(t){return t.substring(t.lastIndexOf("[")+1,t.lastIndexOf("]"))},e.parseHTML=function(t){try{return t.textContent}catch(e){return t}},e.getJidFromUid=function(t){return o.format(r.XMPP.bare_jid_string,s.CometChat.getAppId(),t,r.XMPP.host)}},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};e.__esModule=!0;var o=n(2),s=n(1),i=n(0),a=n(16),u=function(){function t(t){this.store=i.constants.DEFAULT_STORE,s.isFalsy(t)||(this.store=t),this.messagesStore=a.createInstance({name:s.format(i.LOCAL_STORE.STORE_STRING,o.CometChat.getAppId(),i.LOCAL_STORE.MESSAGES_STORE)}),this.messagesStore.setDriver([a.LOCALSTORAGE,a.INDEXEDDB,a.WEBSQL])}return t.getInstance=function(){return null==t.MessagesStore&&(t.MessagesStore=new t),t.MessagesStore},t.prototype.set=function(t,e){return this.messagesStore.setItem(t,e)},t.prototype.remove=function(t){this.messagesStore.removeItem(t)},t.prototype.get=function(t){return this.messagesStore.getItem(t)},t.prototype.getAllMessages=function(){var t=this;console.log({CometChat:o.CometChat});var e={};return new Promise(function(n,o){t.messagesStore.iterate(function(t,n,o){n!=i.constants.MSG_VER_POST&&n!=i.constants.MSG_VER_POST&&(e=r({},e,t))}).then(function(){n(e)})})},t.prototype.clear=function(t){},t.prototype.selectStore=function(t){this.store=t},t.prototype.storeMessages=function(t){var e=this;if(o.CometChat.user.getUid()){var n=o.CometChat.user.getUid(),a={},u=0;return this.get(i.constants.MSG_VER_POST).then(function(o){t.map(function(t){var e;if(!s.isFalsy(t)){0==u&&(u=parseInt(t.getId().toString())),u>t.getId()&&(u=parseInt(t.getId().toString())),o<t.getId()&&(o=parseInt(t.getId().toString()));var i=void 0;i=t.getSender()instanceof Object?t.getSender().getUid():t.getSender(),"group"==t.getReceiverType()&&(i=t.getReceiver()),t.getSender()instanceof Object?t.getSender().getUid()==n&&(i=t.getReceiver()):t.getSender()==n&&(i=t.getReceiver()),a[i]||(a[i]={}),a[i]=r({},a[i],((e={})[t.getId()]=t,e))}}),e.get(i.constants.MSG_VER_PRE).then(function(t){(u>0&&t>u||null==t)&&e.set(i.constants.MSG_VER_PRE,u)})&&o>0&&e.set(i.constants.MSG_VER_POST,o),Object.keys(a).map(function(t){e.get(t).then(function(n){null==n&&(n={}),e.set(t,r({},a[t],n))})}),console.log("this is post",{post:o})}),!0}},t}();e.MessagesStore=u},function(t,e,n){"use strict";e.__esModule=!0;var r=n(0),o=function(){function t(t,e,n,r,o,s){this.guid=t,this.name=e,this.type=n,r&&(this.password=r),o&&(this.icon=o),s&&(this.description=s)}return t.prototype.getGuid=function(){return this.guid},t.prototype.setGuid=function(t){this.guid=t},t.prototype.getName=function(){return this.name},t.prototype.setName=function(t){this.name=t},t.prototype.getType=function(){return this.type},t.prototype.setType=function(t){this.type=t},t.prototype.setPassword=function(t){this.password=t},t.prototype.getIcon=function(){return this.icon},t.prototype.setIcon=function(t){this.icon=t},t.prototype.getDescription=function(){return this.description},t.prototype.setDescription=function(t){this.description=t},t.prototype.getOwner=function(){return this.owner},t.prototype.setOwner=function(t){this.owner=t},t.prototype.getMetadata=function(){return this.metadata},t.prototype.setMetadata=function(t){this.metadata=t},t.prototype.getCreatedAt=function(){return this.createdAt},t.prototype.setCreatedAt=function(t){this.createdAt=t},t.prototype.getUpdatedAt=function(){return this.updatedAt},t.prototype.setUpdatedAt=function(t){this.updatedAt=t},t.prototype.getHasJoined=function(){return this.hasJoined},t.prototype.setHasJoined=function(t){this.hasJoined=t},t.prototype.getWsChannel=function(){return this.wsChannel},t.prototype.setWsChannel=function(t){this.wsChannel=t},t.TYPE=r.GroupType,t.Type=t.TYPE,t}();e.Group=o},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0;var s=n(8),i=n(0),a=n(3),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getData=function(){return this.data},e.prototype.setData=function(t){this.data=t},e.prototype.getSessionId=function(){return this.sessionId},e.prototype.setSessionId=function(t){this.sessionId=t},e.prototype.getCallStatus=function(){return this.callStatus},e.prototype.setCallStatus=function(t){this.callStatus=t},e.prototype.getMetadata=function(){return this.metadata},e.prototype.getSender=function(){return this.getSenderFromData()},e.prototype.setMetadata=function(t){this.metadata=t},e.prototype.getAction=function(){return this.action},e.prototype.setAction=function(t){this.action=t},e.prototype.getInitiatedAt=function(){return this.initiatedAt},e.prototype.setInitiatedAt=function(t){this.initiatedAt=t},e.prototype.setRawData=function(t){this.rawData=t},e.prototype.getRawData=function(){return this.rawData},e.callFromJSON=function(t){var e=new this(t[i.MessageConstatnts.KEYS.RECEIVER],t[i.MessageConstatnts.KEYS.TYPE],t[i.MessageConstatnts.KEYS.RECEIVER_TYPE],i.MessageCategory.CALL),n=t[i.MessageConstatnts.KEYS.DATA];if(e.setAction(n[i.MessageConstatnts.KEYS.ACTION]),n[i.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON]){var r=n[i.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON];if(r[i.CallConstants.CALL_KEYS.CALL_ENTITY]){var o=r[i.CallConstants.CALL_KEYS.CALL_ENTITY];if(o[i.CallConstants.CALL_KEYS.CALL_SESSION_ID]&&(e.sessionId=o[i.CallConstants.CALL_KEYS.CALL_SESSION_ID]),o[i.CallConstants.CALL_KEYS.CALL_STATUS]&&(e.callStatus=o[i.CallConstants.CALL_KEYS.CALL_STATUS]),o[i.CallConstants.CALL_KEYS.CALL_DATA]){var s=o[i.CallConstants.CALL_KEYS.CALL_DATA];if(s[i.CallConstants.CALL_KEYS.CALL_METADATA]&&(e.metadata=s[i.CallConstants.CALL_KEYS.CALL_METADATA]),s[i.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES])s[i.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES]}o[i.CallConstants.CALL_KEYS.CALL_INITIATED_AT]&&(e.initiatedAt=o[i.CallConstants.CALL_KEYS.CALL_INITIATED_AT])}}return console.log({call:e}),e},e.prototype.getSenderFromData=function(){var t=this.getData();if(t[i.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][i.CallConstants.CALL_KEYS.CALL_ENTITY][i.CallConstants.CALL_KEYS.CALL_DATA][i.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][i.CallConstants.CALL_KEYS.CALL_SENDER])return console.log("this is sender",new a.AppUser(t[i.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][i.CallConstants.CALL_KEYS.CALL_ENTITY][i.CallConstants.CALL_KEYS.CALL_DATA][i.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][i.CallConstants.CALL_KEYS.CALL_SENDER][i.CallConstants.CALL_KEYS.CALL_ENTITY])),new a.AppUser(t[i.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][i.CallConstants.CALL_KEYS.CALL_ENTITY][i.CallConstants.CALL_KEYS.CALL_DATA][i.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][i.CallConstants.CALL_KEYS.CALL_SENDER][i.CallConstants.CALL_KEYS.CALL_ENTITY])},e.TYPE=i.MessageConstatnts.TYPE,e.RECEIVER_TYPE=i.MessageConstatnts.RECEIVER_TYPE,e.CATEGORY=i.MessageConstatnts.CATEGORY,e.ACTION_TYPE=i.ActionConstatnts.ACTION_TYPE,e}(s.BaseMessage);e.Call=u},function(t,e,n){"use strict";e.__esModule=!0;var r=n(14),o=n(9),s=n(15),i=n(4),a=n(10),u=n(1),c=n(0),l=n(6),h=n(17),d=n(12),p=function(){function t(){}return t.trasformXMPPMessage=function(t){console.log("trasformJSONMessge",{msg:t});var e={};try{var n=JSON.parse(unescape(o.parseHTML(t.getElementsByTagName("body")[0])).trim().toString());e=this.trasformJSONMessge(n),console.log("trasformJSONMessge",{msg:t,JSONBody:n})}catch(t){return e}return e},t.trasformJSONMessge=function(t){var e;switch(console.log("tranforming json message :",{message:t}),t.category){case c.MessageConstatnts.CATEGORY.ACTION:console.log("tranforming json message :",{message:t}),e=h.Action.actionFromJSON(t);break;case c.MessageConstatnts.CATEGORY.CALL:e=d.Call.callFromJSON(t);break;case c.MessageConstatnts.CATEGORY.MESSAGE:switch(t.type){case c.MessageConstatnts.TYPE.TEXT:e=new r.TextMessage(t[c.MessageConstatnts.KEYS.RECEIVER],t[c.MessageConstatnts.KEYS.DATA][c.MessageConstatnts.KEYS.TEXT],t[c.MessageConstatnts.KEYS.TYPE],t[c.MessageConstatnts.KEYS.RECEIVER_TYPE]);break;default:e=new s.MediaMessage(t[c.MessageConstatnts.KEYS.RECEIVER],t[c.MessageConstatnts.KEYS.DATA][c.MessageConstatnts.KEYS.URL],t[c.MessageConstatnts.KEYS.TYPE],t[c.MessageConstatnts.KEYS.RECEIVER_TYPE])}}try{Object.assign(e,t),t=e}catch(t){}return t},t.getOfflineHistory=function(e,n){void 0===e&&(e=1e3),void 0===n&&(n=1);var r=a.MessagesStore.getInstance(),o=[];i.makeApiCall("getMessages",{},this.createData(e,n)).then(function(e){return u.isFalsy(e.data)||e.data.map(function(e){l.XMPPConnectionHelper.getInstance().trigerMessageHandler(e),o.push(t.trasformJSONMessge(e))}),r.storeMessages(o)})},t.createData=function(t,e){return void 0===e&&(e=0),{per_page:t,cursorValue:e,cursorField:c.MessageConstatnts.PAGINATION.CURSOR_FILEDS.ID,cursorAffix:u.isFalsy(e)?c.MessageConstatnts.PAGINATION.AFFIX.PREPEND:c.MessageConstatnts.PAGINATION.AFFIX.APPEND}},t}();e.MessageController=p},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0;var s=n(8),i=n(0),a=n(3),u=function(t){function e(e,n,r,o){var s=t.call(this,e,r,o,i.MessageCategory.MESSAGE)||this;switch(r){case"text":s.data={text:n},s.text=n}return s}return o(e,t),e.prototype.getSender=function(){return this.getSenderFromData()},e.prototype.getMeta=function(){return this.meta},e.prototype.setMeta=function(t){this.meta=t},e.prototype.getData=function(){return this.data},e.prototype.setData=function(t){this.data=t},e.prototype.getText=function(){return this.text},e.prototype.setText=function(t){this.text=t},e.prototype.getSenderFromData=function(){var t=this.getData();if(t[i.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][i.MessageConstatnts.KEYS.SENDER][i.ResponseConstants.RESPONSE_KEYS.KEY_ENTITITY])return new a.AppUser(t[i.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][i.MessageConstatnts.KEYS.SENDER][i.ResponseConstants.RESPONSE_KEYS.KEY_ENTITITY])},e.TYPE=i.MessageConstatnts.TYPE.TEXT,e.RECEIVER_TYPE=i.MessageConstatnts.RECEIVER_TYPE,e.CATEGORY=i.MessageConstatnts.CATEGORY.MESSAGE,e}(s.BaseMessage);e.TextMessage=u},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0;var s=n(8),i=n(0),a=n(3),u=function(t){function e(e,n,r,o){var s=t.call(this,e,r,o,i.MessageCategory.MESSAGE)||this;return s.data={url:n instanceof File?void 0:n},s.file=n,n instanceof File||(s.url=n),s}return o(e,t),e.prototype.getSender=function(){return this.getSenderFromData()},e.prototype.getUrl=function(){return this.url},e.prototype.setUrl=function(t){this.url=t},e.prototype.getMeta=function(){return this.meta},e.prototype.setMeta=function(t){this.meta=t},e.prototype.getData=function(){return this.data},e.prototype.setData=function(t){this.data=t},e.prototype.getSenderFromData=function(){var t=this.getData();if(t[i.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][i.MessageConstatnts.KEYS.SENDER][i.ResponseConstants.RESPONSE_KEYS.KEY_ENTITITY])return new a.AppUser(t[i.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][i.MessageConstatnts.KEYS.SENDER][i.ResponseConstants.RESPONSE_KEYS.KEY_ENTITITY])},e.TYPE=i.MessageConstatnts.TYPE,e.RECEIVER_TYPE=i.MessageConstatnts.RECEIVER_TYPE,e.CATEGORY=i.MessageConstatnts.CATEGORY,e}(s.BaseMessage);e.MediaMessage=u},function(t,e,n){(function(e){var n;t.exports=function t(e,r,o){function s(a,u){if(!r[a]){if(!e[a]){var c="function"==typeof n&&n;if(!u&&c)return n(a,!0);if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var h=r[a]={exports:{}};e[a][0].call(h.exports,function(t){var n=e[a][1][t];return s(n||t)},h,h.exports,t,e,r,o)}return r[a].exports}for(var i="function"==typeof n&&n,a=0;a<o.length;a++)s(o[a]);return s}({1:[function(t,n,r){(function(t){"use strict";var e,r,o=t.MutationObserver||t.WebKitMutationObserver;if(o){var s=0,i=new o(l),a=t.document.createTextNode("");i.observe(a,{characterData:!0}),e=function(){a.data=s=++s%2}}else if(t.setImmediate||void 0===t.MessageChannel)e="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){l(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(l,0)};else{var u=new t.MessageChannel;u.port1.onmessage=l,e=function(){u.port2.postMessage(0)}}var c=[];function l(){var t,e;r=!0;for(var n=c.length;n;){for(e=c,c=[],t=-1;++t<n;)e[t]();n=c.length}r=!1}n.exports=function(t){1!==c.push(t)||r||e()}}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,n){"use strict";var r=t(1);function o(){}var s={},i=["REJECTED"],a=["FULFILLED"],u=["PENDING"];function c(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,t!==o&&p(this,t)}function l(t,e,n){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function h(t,e,n){r(function(){var r;try{r=e(n)}catch(e){return s.reject(t,e)}r===t?s.reject(t,new TypeError("Cannot resolve promise with itself")):s.resolve(t,r)})}function d(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function p(t,e){var n=!1;function r(e){n||(n=!0,s.reject(t,e))}function o(e){n||(n=!0,s.resolve(t,e))}var i=f(function(){e(o,r)});"error"===i.status&&r(i.value)}function f(t,e){var n={};try{n.value=t(e),n.status="success"}catch(t){n.status="error",n.value=t}return n}e.exports=c,c.prototype.catch=function(t){return this.then(null,t)},c.prototype.then=function(t,e){if("function"!=typeof t&&this.state===a||"function"!=typeof e&&this.state===i)return this;var n=new this.constructor(o);if(this.state!==u){var r=this.state===a?t:e;h(n,r,this.outcome)}else this.queue.push(new l(n,t,e));return n},l.prototype.callFulfilled=function(t){s.resolve(this.promise,t)},l.prototype.otherCallFulfilled=function(t){h(this.promise,this.onFulfilled,t)},l.prototype.callRejected=function(t){s.reject(this.promise,t)},l.prototype.otherCallRejected=function(t){h(this.promise,this.onRejected,t)},s.resolve=function(t,e){var n=f(d,e);if("error"===n.status)return s.reject(t,n.value);var r=n.value;if(r)p(t,r);else{t.state=a,t.outcome=e;for(var o=-1,i=t.queue.length;++o<i;)t.queue[o].callFulfilled(e)}return t},s.reject=function(t,e){t.state=i,t.outcome=e;for(var n=-1,r=t.queue.length;++n<r;)t.queue[n].callRejected(e);return t},c.resolve=function(t){return t instanceof this?t:s.resolve(new this(o),t)},c.reject=function(t){var e=new this(o);return s.reject(e,t)},c.all=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);for(var i=new Array(n),a=0,u=-1,c=new this(o);++u<n;)l(t[u],u);return c;function l(t,o){e.resolve(t).then(function(t){i[o]=t,++a!==n||r||(r=!0,s.resolve(c,i))},function(t){r||(r=!0,s.reject(c,t))})}},c.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);for(var i,a=-1,u=new this(o);++a<n;)i=t[a],e.resolve(i).then(function(t){r||(r=!0,s.resolve(u,t))},function(t){r||(r=!0,s.reject(u,t))});return u}},{1:1}],3:[function(t,n,r){(function(e){"use strict";"function"!=typeof e.Promise&&(e.Promise=t(2))}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(t){return}}();function s(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(s){if("TypeError"!==s.name)throw s;for(var n="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,r=new n,o=0;o<t.length;o+=1)r.append(t[o]);return r.getBlob(e.type)}}"undefined"==typeof Promise&&t(3);var i=Promise;function a(t,e){e&&t.then(function(t){e(null,t)},function(t){e(t)})}function u(t,e,n){"function"==typeof e&&t.then(e),"function"==typeof n&&t.catch(n)}function c(t){return"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t)),t}function l(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var h="local-forage-detect-blob-support",d=void 0,p={},f=Object.prototype.toString,_="readonly",m="readwrite";function g(t){return"boolean"==typeof d?i.resolve(d):function(t){return new i(function(e){var n=t.transaction(h,m),r=s([""]);n.objectStore(h).put(r,"key"),n.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)},n.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);e(n||!t||parseInt(t[1],10)>=43)}}).catch(function(){return!1})}(t).then(function(t){return d=t})}function S(t){var e=p[t.name],n={};n.promise=new i(function(t,e){n.resolve=t,n.reject=e}),e.deferredOperations.push(n),e.dbReady?e.dbReady=e.dbReady.then(function(){return n.promise}):e.dbReady=n.promise}function E(t){var e=p[t.name],n=e.deferredOperations.pop();if(n)return n.resolve(),n.promise}function A(t,e){var n=p[t.name],r=n.deferredOperations.pop();if(r)return r.reject(e),r.promise}function C(t,e){return new i(function(n,r){if(p[t.name]=p[t.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},t.db){if(!e)return n(t.db);S(t),t.db.close()}var s=[t.name];e&&s.push(t.version);var i=o.open.apply(o,s);e&&(i.onupgradeneeded=function(e){var n=i.result;try{n.createObjectStore(t.storeName),e.oldVersion<=1&&n.createObjectStore(h)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+t.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+t.storeName+'" already exists.')}}),i.onerror=function(t){t.preventDefault(),r(i.error)},i.onsuccess=function(){n(i.result),E(t)}})}function y(t){return C(t,!1)}function T(t){return C(t,!0)}function v(t,e){if(!t.db)return!0;var n=!t.db.objectStoreNames.contains(t.storeName),r=t.version<t.db.version,o=t.version>t.db.version;if(r&&(t.version!==e&&console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),o||n){if(n){var s=t.db.version+1;s>t.version&&(t.version=s)}return!0}return!1}function b(t){var e=function(t){for(var e=t.length,n=new ArrayBuffer(e),r=new Uint8Array(n),o=0;o<e;o++)r[o]=t.charCodeAt(o);return n}(atob(t.data));return s([e],{type:t.type})}function N(t){return t&&t.__local_forage_encoded_blob}function I(t){var e=this,n=e._initReady().then(function(){var t=p[e._dbInfo.name];if(t&&t.dbReady)return t.dbReady});return u(n,t,t),n}function O(t,e,n,r){void 0===r&&(r=1);try{var o=t.db.transaction(t.storeName,e);n(null,o)}catch(o){if(r>0&&(!t.db||"InvalidStateError"===o.name||"NotFoundError"===o.name))return i.resolve().then(function(){if(!t.db||"NotFoundError"===o.name&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),T(t)}).then(function(){return function(t){S(t);for(var e=p[t.name],n=e.forages,r=0;r<n.length;r++){var o=n[r];o._dbInfo.db&&(o._dbInfo.db.close(),o._dbInfo.db=null)}return t.db=null,y(t).then(function(e){return t.db=e,v(t)?T(t):e}).then(function(r){t.db=e.db=r;for(var o=0;o<n.length;o++)n[o]._dbInfo.db=r}).catch(function(e){throw A(t,e),e})}(t).then(function(){O(t,e,n,r-1)})}).catch(n);n(o)}}var M={_driver:"asyncStorage",_initStorage:function(t){var e=this,n={db:null};if(t)for(var r in t)n[r]=t[r];var o=p[n.name];o||(o={forages:[],db:null,dbReady:null,deferredOperations:[]},p[n.name]=o),o.forages.push(e),e._initReady||(e._initReady=e.ready,e.ready=I);var s=[];function a(){return i.resolve()}for(var u=0;u<o.forages.length;u++){var c=o.forages[u];c!==e&&s.push(c._initReady().catch(a))}var l=o.forages.slice(0);return i.all(s).then(function(){return n.db=o.db,y(n)}).then(function(t){return n.db=t,v(n,e._defaultConfig.version)?T(n):t}).then(function(t){n.db=o.db=t,e._dbInfo=n;for(var r=0;r<l.length;r++){var s=l[r];s!==e&&(s._dbInfo.db=n.db,s._dbInfo.version=n.version)}})},_support:function(){try{if(!o)return!1;var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),e="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!t||e)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(t){return!1}}(),iterate:function(t,e){var n=this,r=new i(function(e,r){n.ready().then(function(){O(n._dbInfo,_,function(o,s){if(o)return r(o);try{var i=s.objectStore(n._dbInfo.storeName),a=i.openCursor(),u=1;a.onsuccess=function(){var n=a.result;if(n){var r=n.value;N(r)&&(r=b(r));var o=t(r,n.key,u++);void 0!==o?e(o):n.continue()}else e()},a.onerror=function(){r(a.error)}}catch(t){r(t)}})}).catch(r)});return a(r,e),r},getItem:function(t,e){var n=this;t=c(t);var r=new i(function(e,r){n.ready().then(function(){O(n._dbInfo,_,function(o,s){if(o)return r(o);try{var i=s.objectStore(n._dbInfo.storeName),a=i.get(t);a.onsuccess=function(){var t=a.result;void 0===t&&(t=null),N(t)&&(t=b(t)),e(t)},a.onerror=function(){r(a.error)}}catch(t){r(t)}})}).catch(r)});return a(r,e),r},setItem:function(t,e,n){var r=this;t=c(t);var o=new i(function(n,o){var s;r.ready().then(function(){return s=r._dbInfo,"[object Blob]"===f.call(e)?g(s.db).then(function(t){return t?e:(n=e,new i(function(t,e){var r=new FileReader;r.onerror=e,r.onloadend=function(e){var r=btoa(e.target.result||"");t({__local_forage_encoded_blob:!0,data:r,type:n.type})},r.readAsBinaryString(n)}));var n}):e}).then(function(e){O(r._dbInfo,m,function(s,i){if(s)return o(s);try{var a=i.objectStore(r._dbInfo.storeName);null===e&&(e=void 0);var u=a.put(e,t);i.oncomplete=function(){void 0===e&&(e=null),n(e)},i.onabort=i.onerror=function(){var t=u.error?u.error:u.transaction.error;o(t)}}catch(t){o(t)}})}).catch(o)});return a(o,n),o},removeItem:function(t,e){var n=this;t=c(t);var r=new i(function(e,r){n.ready().then(function(){O(n._dbInfo,m,function(o,s){if(o)return r(o);try{var i=s.objectStore(n._dbInfo.storeName),a=i.delete(t);s.oncomplete=function(){e()},s.onerror=function(){r(a.error)},s.onabort=function(){var t=a.error?a.error:a.transaction.error;r(t)}}catch(t){r(t)}})}).catch(r)});return a(r,e),r},clear:function(t){var e=this,n=new i(function(t,n){e.ready().then(function(){O(e._dbInfo,m,function(r,o){if(r)return n(r);try{var s=o.objectStore(e._dbInfo.storeName),i=s.clear();o.oncomplete=function(){t()},o.onabort=o.onerror=function(){var t=i.error?i.error:i.transaction.error;n(t)}}catch(t){n(t)}})}).catch(n)});return a(n,t),n},length:function(t){var e=this,n=new i(function(t,n){e.ready().then(function(){O(e._dbInfo,_,function(r,o){if(r)return n(r);try{var s=o.objectStore(e._dbInfo.storeName),i=s.count();i.onsuccess=function(){t(i.result)},i.onerror=function(){n(i.error)}}catch(t){n(t)}})}).catch(n)});return a(n,t),n},key:function(t,e){var n=this,r=new i(function(e,r){t<0?e(null):n.ready().then(function(){O(n._dbInfo,_,function(o,s){if(o)return r(o);try{var i=s.objectStore(n._dbInfo.storeName),a=!1,u=i.openCursor();u.onsuccess=function(){var n=u.result;n?0===t?e(n.key):a?e(n.key):(a=!0,n.advance(t)):e(null)},u.onerror=function(){r(u.error)}}catch(t){r(t)}})}).catch(r)});return a(r,e),r},keys:function(t){var e=this,n=new i(function(t,n){e.ready().then(function(){O(e._dbInfo,_,function(r,o){if(r)return n(r);try{var s=o.objectStore(e._dbInfo.storeName),i=s.openCursor(),a=[];i.onsuccess=function(){var e=i.result;e?(a.push(e.key),e.continue()):t(a)},i.onerror=function(){n(i.error)}}catch(t){n(t)}})}).catch(n)});return a(n,t),n},dropInstance:function(t,e){e=l.apply(this,arguments);var n,r=this.config();if((t="function"!=typeof t&&t||{}).name||(t.name=t.name||r.name,t.storeName=t.storeName||r.storeName),t.name){var s=t.name===r.name&&this._dbInfo.db,u=s?i.resolve(this._dbInfo.db):y(t).then(function(e){var n=p[t.name],r=n.forages;n.db=e;for(var o=0;o<r.length;o++)r[o]._dbInfo.db=e;return e});n=t.storeName?u.then(function(e){if(e.objectStoreNames.contains(t.storeName)){var n=e.version+1;S(t);var r=p[t.name],s=r.forages;e.close();for(var a=0;a<s.length;a++){var u=s[a];u._dbInfo.db=null,u._dbInfo.version=n}var c=new i(function(e,r){var s=o.open(t.name,n);s.onerror=function(t){var e=s.result;e.close(),r(t)},s.onupgradeneeded=function(){var e=s.result;e.deleteObjectStore(t.storeName)},s.onsuccess=function(){var t=s.result;t.close(),e(t)}});return c.then(function(t){r.db=t;for(var e=0;e<s.length;e++){var n=s[e];n._dbInfo.db=t,E(n._dbInfo)}}).catch(function(e){throw(A(t,e)||i.resolve()).catch(function(){}),e})}}):u.then(function(e){S(t);var n=p[t.name],r=n.forages;e.close();for(var s=0;s<r.length;s++){var a=r[s];a._dbInfo.db=null}var u=new i(function(e,n){var r=o.deleteDatabase(t.name);r.onerror=r.onblocked=function(t){var e=r.result;e&&e.close(),n(t)},r.onsuccess=function(){var t=r.result;t&&t.close(),e(t)}});return u.then(function(t){n.db=t;for(var e=0;e<r.length;e++){var o=r[e];E(o._dbInfo)}}).catch(function(e){throw(A(t,e)||i.resolve()).catch(function(){}),e})})}else n=i.reject("Invalid arguments");return a(n,e),n}},R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",L="~~local_forage_type~",w=/^~~local_forage_type~([^~]+)~/,P="__lfsc__:",x=P.length,D="arbf",U="blob",Y="si08",k="ui08",j="uic8",G="si16",F="si32",H="ur16",q="ui32",B="fl32",K="fl64",X=x+D.length,J=Object.prototype.toString;function V(t){var e,n,r,o,s,i=.75*t.length,a=t.length,u=0;"="===t[t.length-1]&&(i--,"="===t[t.length-2]&&i--);var c=new ArrayBuffer(i),l=new Uint8Array(c);for(e=0;e<a;e+=4)n=R.indexOf(t[e]),r=R.indexOf(t[e+1]),o=R.indexOf(t[e+2]),s=R.indexOf(t[e+3]),l[u++]=n<<2|r>>4,l[u++]=(15&r)<<4|o>>2,l[u++]=(3&o)<<6|63&s;return c}function W(t){var e,n=new Uint8Array(t),r="";for(e=0;e<n.length;e+=3)r+=R[n[e]>>2],r+=R[(3&n[e])<<4|n[e+1]>>4],r+=R[(15&n[e+1])<<2|n[e+2]>>6],r+=R[63&n[e+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}var $={serialize:function(t,e){var n="";if(t&&(n=J.call(t)),t&&("[object ArrayBuffer]"===n||t.buffer&&"[object ArrayBuffer]"===J.call(t.buffer))){var r,o=P;t instanceof ArrayBuffer?(r=t,o+=D):(r=t.buffer,"[object Int8Array]"===n?o+=Y:"[object Uint8Array]"===n?o+=k:"[object Uint8ClampedArray]"===n?o+=j:"[object Int16Array]"===n?o+=G:"[object Uint16Array]"===n?o+=H:"[object Int32Array]"===n?o+=F:"[object Uint32Array]"===n?o+=q:"[object Float32Array]"===n?o+=B:"[object Float64Array]"===n?o+=K:e(new Error("Failed to get type for BinaryArray"))),e(o+W(r))}else if("[object Blob]"===n){var s=new FileReader;s.onload=function(){var n=L+t.type+"~"+W(this.result);e(P+U+n)},s.readAsArrayBuffer(t)}else try{e(JSON.stringify(t))}catch(n){console.error("Couldn't convert value into a JSON string: ",t),e(null,n)}},deserialize:function(t){if(t.substring(0,x)!==P)return JSON.parse(t);var e,n=t.substring(X),r=t.substring(x,X);if(r===U&&w.test(n)){var o=n.match(w);e=o[1],n=n.substring(o[0].length)}var i=V(n);switch(r){case D:return i;case U:return s([i],{type:e});case Y:return new Int8Array(i);case k:return new Uint8Array(i);case j:return new Uint8ClampedArray(i);case G:return new Int16Array(i);case H:return new Uint16Array(i);case F:return new Int32Array(i);case q:return new Uint32Array(i);case B:return new Float32Array(i);case K:return new Float64Array(i);default:throw new Error("Unkown type: "+r)}},stringToBuffer:V,bufferToString:W};function z(t,e,n,r){t.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function Q(t,e,n,r,o,s){t.executeSql(n,r,o,function(t,i){i.code===i.SYNTAX_ERR?t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[e.storeName],function(t,a){a.rows.length?s(t,i):z(t,e,function(){t.executeSql(n,r,o,s)},s)},s):s(t,i)},s)}var Z={_driver:"webSQLStorage",_initStorage:function(t){var e=this,n={db:null};if(t)for(var r in t)n[r]="string"!=typeof t[r]?t[r].toString():t[r];var o=new i(function(t,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(t){return r(t)}n.db.transaction(function(o){z(o,n,function(){e._dbInfo=n,t()},function(t,e){r(e)})},r)});return n.serializer=$,o},_support:"function"==typeof openDatabase,iterate:function(t,e){var n=this,r=new i(function(e,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){Q(n,o,"SELECT * FROM "+o.storeName,[],function(n,r){for(var s=r.rows,i=s.length,a=0;a<i;a++){var u=s.item(a),c=u.value;if(c&&(c=o.serializer.deserialize(c)),void 0!==(c=t(c,u.key,a+1)))return void e(c)}e()},function(t,e){r(e)})})}).catch(r)});return a(r,e),r},getItem:function(t,e){var n=this;t=c(t);var r=new i(function(e,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){Q(n,o,"SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[t],function(t,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=o.serializer.deserialize(r)),e(r)},function(t,e){r(e)})})}).catch(r)});return a(r,e),r},setItem:function(t,e,n){return function t(e,n,r,o){var s=this;e=c(e);var u=new i(function(i,a){s.ready().then(function(){void 0===n&&(n=null);var u=n,c=s._dbInfo;c.serializer.serialize(n,function(n,l){l?a(l):c.db.transaction(function(t){Q(t,c,"INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[e,n],function(){i(u)},function(t,e){a(e)})},function(n){if(n.code===n.QUOTA_ERR){if(o>0)return void i(t.apply(s,[e,u,r,o-1]));a(n)}})})}).catch(a)});return a(u,r),u}.apply(this,[t,e,n,1])},removeItem:function(t,e){var n=this;t=c(t);var r=new i(function(e,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){Q(n,o,"DELETE FROM "+o.storeName+" WHERE key = ?",[t],function(){e()},function(t,e){r(e)})})}).catch(r)});return a(r,e),r},clear:function(t){var e=this,n=new i(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){Q(e,r,"DELETE FROM "+r.storeName,[],function(){t()},function(t,e){n(e)})})}).catch(n)});return a(n,t),n},length:function(t){var e=this,n=new i(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){Q(e,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],function(e,n){var r=n.rows.item(0).c;t(r)},function(t,e){n(e)})})}).catch(n)});return a(n,t),n},key:function(t,e){var n=this,r=new i(function(e,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){Q(n,o,"SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[t+1],function(t,n){var r=n.rows.length?n.rows.item(0).key:null;e(r)},function(t,e){r(e)})})}).catch(r)});return a(r,e),r},keys:function(t){var e=this,n=new i(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){Q(e,r,"SELECT key FROM "+r.storeName,[],function(e,n){for(var r=[],o=0;o<n.rows.length;o++)r.push(n.rows.item(o).key);t(r)},function(t,e){n(e)})})}).catch(n)});return a(n,t),n},dropInstance:function(t,e){e=l.apply(this,arguments);var n=this.config();(t="function"!=typeof t&&t||{}).name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName);var r,o=this;return a(r=t.name?new i(function(e){var r;r=t.name===n.name?o._dbInfo.db:openDatabase(t.name,"","",0),t.storeName?e({db:r,storeNames:[t.storeName]}):e(function(t){return new i(function(e,n){t.transaction(function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(n,r){for(var o=[],s=0;s<r.rows.length;s++)o.push(r.rows.item(s).name);e({db:t,storeNames:o})},function(t,e){n(e)})},function(t){n(t)})})}(r))}).then(function(t){return new i(function(e,n){t.db.transaction(function(r){function o(t){return new i(function(e,n){r.executeSql("DROP TABLE IF EXISTS "+t,[],function(){e()},function(t,e){n(e)})})}for(var s=[],a=0,u=t.storeNames.length;a<u;a++)s.push(o(t.storeNames[a]));i.all(s).then(function(){e()}).catch(function(t){n(t)})},function(t){n(t)})})}):i.reject("Invalid arguments"),e),r}};function tt(t,e){var n=t.name+"/";return t.storeName!==e.storeName&&(n+=t.storeName+"/"),n}function et(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(t){return!0}}()||localStorage.length>0}var nt={_driver:"localStorageWrapper",_initStorage:function(t){var e={};if(t)for(var n in t)e[n]=t[n];return e.keyPrefix=tt(t,this._defaultConfig),et()?(this._dbInfo=e,e.serializer=$,i.resolve()):i.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return!1}}(),iterate:function(t,e){var n=this,r=n.ready().then(function(){for(var e=n._dbInfo,r=e.keyPrefix,o=r.length,s=localStorage.length,i=1,a=0;a<s;a++){var u=localStorage.key(a);if(0===u.indexOf(r)){var c=localStorage.getItem(u);if(c&&(c=e.serializer.deserialize(c)),void 0!==(c=t(c,u.substring(o),i++)))return c}}});return a(r,e),r},getItem:function(t,e){var n=this;t=c(t);var r=n.ready().then(function(){var e=n._dbInfo,r=localStorage.getItem(e.keyPrefix+t);return r&&(r=e.serializer.deserialize(r)),r});return a(r,e),r},setItem:function(t,e,n){var r=this;t=c(t);var o=r.ready().then(function(){void 0===e&&(e=null);var n=e;return new i(function(o,s){var i=r._dbInfo;i.serializer.serialize(e,function(e,r){if(r)s(r);else try{localStorage.setItem(i.keyPrefix+t,e),o(n)}catch(t){"QuotaExceededError"!==t.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||s(t),s(t)}})})});return a(o,n),o},removeItem:function(t,e){var n=this;t=c(t);var r=n.ready().then(function(){var e=n._dbInfo;localStorage.removeItem(e.keyPrefix+t)});return a(r,e),r},clear:function(t){var e=this,n=e.ready().then(function(){for(var t=e._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(t)&&localStorage.removeItem(r)}});return a(n,t),n},length:function(t){var e=this.keys().then(function(t){return t.length});return a(e,t),e},key:function(t,e){var n=this,r=n.ready().then(function(){var e,r=n._dbInfo;try{e=localStorage.key(t)}catch(t){e=null}return e&&(e=e.substring(r.keyPrefix.length)),e});return a(r,e),r},keys:function(t){var e=this,n=e.ready().then(function(){for(var t=e._dbInfo,n=localStorage.length,r=[],o=0;o<n;o++){var s=localStorage.key(o);0===s.indexOf(t.keyPrefix)&&r.push(s.substring(t.keyPrefix.length))}return r});return a(n,t),n},dropInstance:function(t,e){if(e=l.apply(this,arguments),!(t="function"!=typeof t&&t||{}).name){var n=this.config();t.name=t.name||n.name,t.storeName=t.storeName||n.storeName}var r,o=this;return a(r=t.name?new i(function(e){t.storeName?e(tt(t,o._defaultConfig)):e(t.name+"/")}).then(function(t){for(var e=localStorage.length-1;e>=0;e--){var n=localStorage.key(e);0===n.indexOf(t)&&localStorage.removeItem(n)}}):i.reject("Invalid arguments"),e),r}},rt=function(t,e){for(var n=t.length,r=0;r<n;){if((o=t[r])===(s=e)||"number"==typeof o&&"number"==typeof s&&isNaN(o)&&isNaN(s))return!0;r++}var o,s;return!1},ot=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},st={},it={},at={INDEXEDDB:M,WEBSQL:Z,LOCALSTORAGE:nt},ut=[at.INDEXEDDB._driver,at.WEBSQL._driver,at.LOCALSTORAGE._driver],ct=["dropInstance"],lt=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ct),ht={description:"",driver:ut.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function dt(t,e){t[e]=function(){var n=arguments;return t.ready().then(function(){return t[e].apply(t,n)})}}function pt(){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e)for(var n in e)e.hasOwnProperty(n)&&(ot(e[n])?arguments[0][n]=e[n].slice():arguments[0][n]=e[n])}return arguments[0]}var ft=function(){function t(e){for(var n in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),at)if(at.hasOwnProperty(n)){var r=at[n],o=r._driver;this[n]=o,st[o]||this.defineDriver(r)}this._defaultConfig=pt({},ht),this._config=pt({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return t.prototype.config=function(t){if("object"===(void 0===t?"undefined":r(t))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t){if("storeName"===e&&(t[e]=t[e].replace(/\W/g,"_")),"version"===e&&"number"!=typeof t[e])return new Error("Database version must be a number.");this._config[e]=t[e]}return!("driver"in t&&t.driver)||this.setDriver(this._config.driver)}return"string"==typeof t?this._config[t]:this._config},t.prototype.defineDriver=function(t,e,n){var r=new i(function(e,n){try{var r=t._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver)return void n(o);for(var s=lt.concat("_initStorage"),u=0,c=s.length;u<c;u++){var l=s[u],h=!rt(ct,l);if((h||t[l])&&"function"!=typeof t[l])return void n(o)}!function(){for(var e=function(t){return function(){var e=new Error("Method "+t+" is not implemented by the current driver"),n=i.reject(e);return a(n,arguments[arguments.length-1]),n}},n=0,r=ct.length;n<r;n++){var o=ct[n];t[o]||(t[o]=e(o))}}();var d=function(n){st[r]&&console.info("Redefining LocalForage driver: "+r),st[r]=t,it[r]=n,e()};"_support"in t?t._support&&"function"==typeof t._support?t._support().then(d,n):d(!!t._support):d(!0)}catch(t){n(t)}});return u(r,e,n),r},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(t,e,n){var r=st[t]?i.resolve(st[t]):i.reject(new Error("Driver not found."));return u(r,e,n),r},t.prototype.getSerializer=function(t){var e=i.resolve($);return u(e,t),e},t.prototype.ready=function(t){var e=this,n=e._driverSet.then(function(){return null===e._ready&&(e._ready=e._initDriver()),e._ready});return u(n,t,t),n},t.prototype.setDriver=function(t,e,n){var r=this;ot(t)||(t=[t]);var o=this._getSupportedDrivers(t);function s(){r._config.driver=r.driver()}function a(t){return r._extend(t),s(),r._ready=r._initStorage(r._config),r._ready}var c=null!==this._driverSet?this._driverSet.catch(function(){return i.resolve()}):i.resolve();return this._driverSet=c.then(function(){var t=o[0];return r._dbInfo=null,r._ready=null,r.getDriver(t).then(function(t){r._driver=t._driver,s(),r._wrapLibraryMethodsWithReady(),r._initDriver=function(t){return function(){var e=0;return function n(){for(;e<t.length;){var o=t[e];return e++,r._dbInfo=null,r._ready=null,r.getDriver(o).then(a).catch(n)}s();var u=new Error("No available storage method found.");return r._driverSet=i.reject(u),r._driverSet}()}}(o)})}).catch(function(){s();var t=new Error("No available storage method found.");return r._driverSet=i.reject(t),r._driverSet}),u(this._driverSet,e,n),this._driverSet},t.prototype.supports=function(t){return!!it[t]},t.prototype._extend=function(t){pt(this,t)},t.prototype._getSupportedDrivers=function(t){for(var e=[],n=0,r=t.length;n<r;n++){var o=t[n];this.supports(o)&&e.push(o)}return e},t.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,e=lt.length;t<e;t++)dt(this,lt[t])},t.prototype.createInstance=function(e){return new t(e)},t}(),_t=new ft;e.exports=_t},{3:3}]},{},[4])(4)}).call(this,n(28))},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0;var s=n(8),i=n(11),a=n(3),u=n(0),c=n(1),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.actionFromJSON=function(t){var e=new this(t[u.MessageConstatnts.KEYS.RECEIVER],t[u.MessageConstatnts.KEYS.TYPE],t[u.MessageConstatnts.KEYS.RECEIVER_TYPE],u.MessageCategory.ACTION),n=t[u.MessageConstatnts.KEYS.DATA];if(e.data=n,e.setAction(n[u.MessageConstatnts.KEYS.ACTION]),console.log("Action",{action:e}),n[u.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY])if(n[u.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][u.ActionConstatnts.ACTION_KEYS.ENTITY_TYPE]==u.ActionConstatnts.ACTION_ENTITY_TYPE.USER){var r=new a.AppUser(n[u.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][u.ActionConstatnts.ACTION_KEYS.ENTITY]);Object.assign(r,n[u.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][u.ActionConstatnts.ACTION_KEYS.ENTITY]),e.by=r,e.setSender(r)}else{var o=new i.Group("","","");Object.assign(o,n[u.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][u.ActionConstatnts.ACTION_KEYS.ENTITY]),e.by=o}if(n[u.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR])if(n[u.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][u.ActionConstatnts.ACTION_KEYS.ENTITY_TYPE]==u.ActionConstatnts.ACTION_ENTITY_TYPE.USER){r=new a.AppUser(n[u.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][u.ActionConstatnts.ACTION_KEYS.ENTITY]);Object.assign(r,n[u.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][u.ActionConstatnts.ACTION_KEYS.ENTITY]),e.for=r}else{o=new i.Group("","","");Object.assign(o,n[u.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][u.ActionConstatnts.ACTION_KEYS.ENTITY]),e.for=o}if(n[u.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON])if(n[u.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][u.ActionConstatnts.ACTION_KEYS.ENTITY_TYPE]==u.ActionConstatnts.ACTION_ENTITY_TYPE.USER){r=new a.AppUser(n[u.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][u.ActionConstatnts.ACTION_KEYS.ENTITY]);Object.assign(r,n[u.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][u.ActionConstatnts.ACTION_KEYS.ENTITY]),e.on=r}else{o=new i.Group("","","");Object.assign(o,n[u.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][u.ActionConstatnts.ACTION_KEYS.ENTITY]),e.on=o}return e.setMessage(e.getActionMessage(e)),console.log("This is action Object Return from JSON :",{action:e}),e},e.prototype.setRawData=function(t){this.rawData=t},e.prototype.getRawData=function(){return this.rawData},e.prototype.setMessage=function(t){this.message=t},e.prototype.getMessage=function(){return this.message},e.prototype.setAction=function(t){this.action=t},e.prototype.getAction=function(){return this.action},e.prototype.getSender=function(){return this.getSenderFromData()},e.prototype.setActionBy=function(t){this.by=t},e.prototype.getActionBy=function(){return this.by},e.prototype.setActionOn=function(t){this.on=t},e.prototype.getActionOn=function(){return this.on},e.prototype.setActionFor=function(t){this.for=t},e.prototype.getActionFor=function(){return this.for},e.prototype.getActionMessage=function(t){var e="";switch(console.log("Action Type it is",t.getType()),t.getType()){case u.ActionConstatnts.ACTION_KEYS.ACTION_TYPE_USER:case u.ActionConstatnts.ACTION_KEYS.ACTION_TYPE_GROUP:switch(t.getAction()){case u.ActionConstatnts.ACTION_KEYS.ACTION_CREATED:case u.ActionConstatnts.ACTION_KEYS.ACTION_UPDATED:case u.ActionConstatnts.ACTION_KEYS.ACTION_DELETED:}break;case u.ActionConstatnts.ACTION_KEYS.ACTION_TYPE_GROUP_MEMBER:switch(t.getAction()){case u.ActionConstatnts.ACTION_KEYS.TYPE_MEMBER_JOINED:var n=t.getActionBy(),r=t.getActionFor();e=c.format(u.ActionConstatnts.ActionMessages.ACTION_GROUP_JOINED_MESSAGE,n.getName(),r.getName());break;case u.ActionConstatnts.ACTION_KEYS.TYPE_MEMBER_LEFT:n=t.getActionBy(),r=t.getActionFor();e=c.format(u.ActionConstatnts.ActionMessages.ACTION_GROUP_LEFT_MESSAGE,n.getName(),r.getName());break;case u.ActionConstatnts.ACTION_KEYS.TYPE_MEMBER_KICKED:n=t.getActionBy(),r=t.getActionFor();var o=t.getActionOn();e=c.format(u.ActionConstatnts.ActionMessages.ACTION_MEMBER_KICKED_MESSAGE,n.getName(),o,r.getName());break;case u.ActionConstatnts.ACTION_KEYS.TYPE_MEMBER_OUTCASTED:n=t.getActionBy(),r=t.getActionFor(),o=t.getActionOn();e=c.format(u.ActionConstatnts.ActionMessages.ACTION_MEMBER_OUTCASTED_MESSAGE,n.getName(),r.getName());break;case u.ActionConstatnts.ACTION_KEYS.TYPE_MEMBER_REINSTATED:n=t.getActionBy(),r=t.getActionFor(),o=t.getActionOn();e=c.format(u.ActionConstatnts.ActionMessages.ACTION_MEMBER_REINSTATED_MESSAGE,n.getName(),r.getName());break;case u.ActionConstatnts.ACTION_KEYS.ACTION_SCOPE_CHANGED:break;default:console.log("we are here")}}return e},e.prototype.getSenderFromData=function(){var t=this.data;if(t[u.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY]&&t[u.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][u.ActionConstatnts.ACTION_KEYS.ENTITY_TYPE]==u.ActionConstatnts.ACTION_ENTITY_TYPE.USER){var e=new a.AppUser(t[u.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][u.ActionConstatnts.ACTION_KEYS.ENTITY]);return Object.assign(e,t[u.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][u.ActionConstatnts.ACTION_KEYS.ENTITY]),e}},e.TYPE=u.MessageConstatnts.TYPE,e.RECEIVER_TYPE=u.MessageConstatnts.RECEIVER_TYPE,e.CATEGORY=u.MessageConstatnts.CATEGORY,e.ACTION_TYPE=u.ActionConstatnts.ACTION_TYPE,e}(s.BaseMessage);e.Action=l},function(t,e,n){"use strict";e.__esModule=!0;var r=n(1),o=n(0),s=n(16),i=n(2),a=function(){function t(t){this.store=o.constants.DEFAULT_STORE,r.isFalsy(t)||(this.store=t),this.localStore=s.createInstance({name:r.format(o.LOCAL_STORE.STORE_STRING,i.CometChat.getAppId(),o.LOCAL_STORE.COMMON_STORE)}),this.localStore.setDriver([s.LOCALSTORAGE,s.INDEXEDDB,s.WEBSQL])}return t.getInstance=function(){return null==t.localStorage&&(console.log("Setting local Storage"),t.localStorage=new t),t.localStorage},t.prototype.set=function(t,e){return this.localStore.setItem(t,e)},t.prototype.remove=function(t){this.localStore.removeItem(t)},t.prototype.get=function(t){return this.localStore.getItem(t)},t.prototype.clear=function(t){},t.prototype.selectStore=function(t){this.store=t},t.localStorage=null,t}();e.LocalStorage=a},function(t,e,n){"use strict";e.__esModule=!0;var r=function(){function t(){this.baseUrl="http://kohoutek.cometchat.com/",this.apiVersion="v1",this.apiBaseUrl=this.baseUrl+this.apiVersion+"/",this.adminApiUrl="http://api.cometchat.com/",this.adminApiVersion="v1",this.uriEndpoints={authToken:{endpoint:"users/{{uid}}/auth_tokens",method:"POST",data:{uid:"string|max:100"},isAdminApi:!0},login:{endpoint:"admin/users/auth",method:"POST",data:{uid:"string|max:100"}},logout:{endpoint:"admin/users/auth/{{authToken}}",method:"DELETE"},getMyDetails:{endpoint:"me",method:"GET"},updateMyDetails:{endpoint:"/me",method:"PUT"},users:{endpoint:"users",method:"GET"},user:{endpoint:"users/{{uid}}",method:"GET"},sendFriendRequests:{endpoint:"user/friends",method:"POST",data:{uids:"array<string|max:100>"}},getFriends:{endpoint:"user/friends",method:"GET"},unfriend:{endpoint:"user/friends/{{uid}}/{{gid}}",method:"DELETE",data:{uids:"array<string|max:100>"}},acceptFriendRequest:{endpoint:"user/friends/{{uid}}/accept",method:"PUT",data:{uids:"array<string|max:100>"}},rejectFriendRequest:{endpoint:"user/friends/{{uid}}/reject",method:"DELETE",data:{uids:"array<string|max:100>"}},createGroup:{endpoint:"groups",method:"POST",data:{guid:"required|string|max:100",name:"required|string|max:100",type:"enum|public,protected,password",password:"filled|string|max:100"}},getGroups:{endpoint:"groups",method:"GET"},getGroup:{endpoint:"groups/{{guid}}",method:"GET"},updateGroup:{endpoint:"groups/{{guid}}",method:"PUT"},deleteGroup:{endpoint:"groups/{{guid}}",method:"DELETE"},addGroupMembers:{endpoint:"groups/{{guid}}/members",method:"POST",data:{uids:"array<string|max:100>"}},getGroupMembers:{endpoint:"groups/{{guid}}/members",method:"GET"},joinGroup:{endpoint:"groups/{{guid}}/members",method:"POST"},leaveGroup:{endpoint:"groups/{{guid}}/members",method:"DELETE"},kickGroupMembers:{endpoint:"groups/{{guid}}/members/{{uid}}",method:"DELETE",data:{uids:"array<string|max:100>"}},changeScopeOfMember:{endpoint:"groups/{{guid}}/members/{{uid}}",method:"PUT",data:{uids:"array<string|max:100>"}},banGroupMember:{endpoint:"user/groups/{{guid}}/members/outcasts/{{uid}}",method:"POST",data:{uids:"array<string|max:100>"}},unbanGroupMember:{endpoint:"user/groups/{{guid}}/members/outcasts",method:"DELETE",data:{uids:"array<string|max:100>"}},getBannedGroupMembers:{endpoint:"groups/{{guid}}/outcasts",method:"GET"},promotemoteGroupMember:{endpoint:"user/groups/{{guid}}/promote",method:"PUT",data:{uids:"array<string|max:100>"}},demoteGroupMember:{endpoint:"user/groups/{{guid}}/demote",method:"DELETE",data:{uids:"array<string|max:100>"}},sendMessage:{endpoint:"messages",method:"POST",data:{sender:"array:string:max:100>",isGroupMember:"filled|boolean|bail",data:"required|json"}},getMessages:{endpoint:"messages",method:"GET"},getUserMessages:{endpoint:"users/{{uid}}/messages",method:"GET"},getMessage:{endpoint:"user/messages/{{muid}}",method:"GET"},updateMessage:{endpoint:"user/messages/{{muid}}",method:"PUT",data:{data:"required|json"}},deleteMessage:{endpoint:"user/messages/{{muid}}",method:"DELETE"},createCallSession:{endpoint:"calls",method:"POST",data:{}},updateCallSession:{endpoint:"calls/{{sessionid}}",method:"put",data:{}}}}return t.prototype.getEndpointData=function(t){console.log("getEndpointData");var e=!1;return this.uriEndpoints.hasOwnProperty(t)&&((e=this.uriEndpoints[t]).hasOwnProperty(["isAdminApi"])?e.endpoint=this.adminApiUrl+this.adminApiVersion+"/"+e.endpoint:e.endpoint=this.baseUrl+this.apiVersion+"/"+e.endpoint),e},t}();e.EndpointFactory=r},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0;var s=function(){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.onActionReceived=t[0].onActionRecived,this.onMessageReceived=t[0].onMessageReceived,this.onCallReceived=t[0].onCallReceived}}();e.MessageEventListener=s;var i=function(){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.onUserOnline=t[0].onUserOnline,this.onUserOffline=t[0].onUserOffline}}();e.PresenceEventHandler=i;var a=function(){return function(t,e){this._name=t,this._callback=e}}();e.Listner=a;var u=function(t){function e(e,n,r,o){var s=t.call(this,e,o)||this;return s._eventHander=n,r&&(s._cursor=r),s}return o(e,t),e}(a);e.MessageListner=u;var c=function(t){function e(e,n,r,o){var s=t.call(this,e,o)||this;return s._eventHander=n,r&&(s._cursor=r),s}return o(e,t),e}(a);e.PresenceListner=c},function(t,e,n){"use strict";e.__esModule=!0;var r=n(3),o=n(0),s=function(){function t(){}return t.trasformJSONUser=function(t){var e;try{e=new r.AppUser(t[o.UserConstants.UID]),Object.assign(e,t),t=e}catch(e){console.log({user:t,e:e})}return t},t}();e.UsersController=s},function(t,e,n){"use strict";e.__esModule=!0;var r=n(11),o=n(0),s=function(){function t(){}return t.trasformJSONGroup=function(t){var e;try{e=new r.Group(t[o.GroupConstants.KEYS.GUID],t[o.GroupConstants.KEYS.NAME],t[o.GroupConstants.KEYS.NAME]),Object.assign(e,t),t=e}catch(e){console.log({group:t,e:e})}return t},t}();e.GroupsController=s},function(t,e,n){"use strict";e.__esModule=!0;var r=n(2),o=n(1),s=n(0),i=n(16),a=function(){function t(t){this.store=s.constants.DEFAULT_STORE,o.isFalsy(t)||(this.store=t),this.userStore=i.createInstance({name:o.format(s.LOCAL_STORE.STORE_STRING,r.CometChat.getAppId(),s.LOCAL_STORE.USERS_STORE)}),this.userStore.setDriver([i.LOCALSTORAGE,i.INDEXEDDB,i.WEBSQL])}return t.getInstance=function(){return null==t.UserStore&&(t.UserStore=new t),t.UserStore},t.prototype.set=function(t,e){return this.userStore.setItem(t,e)},t.prototype.remove=function(t){this.userStore.removeItem(t)},t.prototype.get=function(t){return this.userStore.getItem(t)},t.prototype.clear=function(t){},t.prototype.selectStore=function(t){this.store=t},t.prototype.storeUsers=function(t){var e=this;return t.map(function(t){e.set(t.getUid(),t)}),!0},t.prototype.storeUser=function(t){return this.set(t.getUid(),t),!0},t}();e.UserStore=a},function(t,e,n){"use strict";e.__esModule=!0;var r=n(25),o=n(14),s=n(15),i=n(35),a=n(11),u=n(36),c=n(3),l=n(2),h=n(20),d=n(37),p=n(17),f=n(0),_=n(12);e.init=function(t){return e.CometChat.getInstance(t)},e.CometChat=l.CometChat,e.TextMessage=o.TextMessage,e.MediaMessage=s.MediaMessage,e.Action=p.Action,e.Call=_.Call,e.Group=a.Group,e.AppUser=c.AppUser,e.UserMessagesRequest=i.MessagesRequest,e.UserMessagesRequestBuilder=i.MessagesRequestBuilder,e.GroupMessagesRequest=i.MessagesRequest,e.GroupMessagesRequestBuilder=i.MessagesRequestBuilder,e.UsersRequest=r.UsersRequest,e.UsersRequestBuilder=r.UsersRequestBuilder,e.GroupsRequest=u.GroupsRequest,e.GroupsRequestBuilder=u.GroupsRequestBuilder,e.GroupMembersRequest=d.GroupMembersRequest,e.GroupMembersRequestBuilder=d.GroupMembersRequestBuilder,e.OutcastMembersRequest=d.GroupMembersRequest,e.OutCastMembersRequestBuilder=d.GroupOutCastMembersRequestBuilder,e.MessageEventListener=h.MessageEventListener,e.PresenceEventHandler=h.PresenceEventHandler,e.MESSAGE_TYPE=f.MessageConstatnts.TYPE,e.ACTION_TYPE=f.ActionConstatnts.ACTION_TYPE,e.RECEIVER_TYPE=f.MessageConstatnts.RECEIVER_TYPE,e.MESSAGE_REQUEST=f.MessageConstatnts.PAGINATION.CURSOR_FILEDS},function(t,e,n){"use strict";e.__esModule=!0;var r=n(4),o=n(1),s=n(18),i=n(21),a=n(5),u=n(23),c=n(6),l=n(0),h=n(2),d=function(){function t(e){this.limit=t.DEFAULT_LIMIT,this.cursor=-1,this.total=-1,this.next_page=1,this.last_page=-1,this.current_page=1,this.total_pages=-1,this.pagination={total:0,count:0,per_page:0,current_page:0,total_pages:0,links:[]},this.store=s.LocalStorage.getInstance(),t.userStore=u.UserStore.getInstance(),o.isFalsy(e)||(this.limit=e.limit,console.log(e.limit),this.search_keyword=e.searchKeyWord)}return t.prototype.fetchPrevious=function(){var e=this;return new Promise(function(n,o){if(0!=e.next_page)return r.makeApiCall("users",{},e.getPreData()).then(function(r){if(r.meta&&(e.total_pages=r.meta.pagination.total_pages),r.data.length>0){e.pagination=r.meta.pagination;var o=[];r.data.map(function(t,e){o.push(i.UsersController.trasformJSONUser(t))}),t.userStore.storeUsers(o),n(o)}n([])},function(t){o(new a.CustomError(t))});o("Error: no mre users")})},t.prototype.fetchNext=function(){var e=this;return new Promise(function(n,s){r.makeApiCall("users",{},e.getNextData()).then(function(r){if(r.meta&&(e.total_pages=r.meta.pagination.total_pages),r.data.length>0){e.pagination=r.meta.pagination;var s=[],a=[];r.data.map(function(t){s.push(i.UsersController.trasformJSONUser(t)),a.push(o.format(l.XMPP.username_string,h.CometChat.getAppId(),t[l.UserConstants.UID]))}),c.XMPPConnectionHelper.getInstance().getPresenceInfo(a,function(e){console.log("This is important information",{userList:s,presences:e}),s.map(function(t,n){e[n]&&(t.setLastActiveAt(e[n].getLastActiveAt()),t.setStatus(e[n].getStatus()))}),t.userStore.storeUsers(s),n(s)})}else n([])},function(t){s(new a.CustomError(t))})})},t.prototype.getNextData=function(){var t={};if(t.per_page=this.limit,1==this.current_page)t.page=this.next_page,this.next_page++,this.current_page++;else{if(this.next_page>this.total_pages)return t.page=this.next_page,t;t.page=++this.next_page}return t},t.prototype.getPreData=function(){var t={};return t.per_page=this.limit,this.next_page>=0?(this.next_page>0&&(t.page=--this.next_page),t):(console.log({paginationData:t}),t)},t.MAX_LIMIT=2,t.DEFAULT_LIMIT=1,t}();e.UsersRequest=d;var p=function(){function t(){}return t.prototype.setLimit=function(t){return this.limit=t,this},t.prototype.setSearchKeyWord=function(t){return this.searchKeyWord=t,this},t.prototype.build=function(){return new d(this)},t}();e.UsersRequestBuilder=p},function(t,e,n){"use strict";e.__esModule=!0;var r=n(19);e.getEndPoint=function(t,e){void 0===t&&(t=""),void 0===e&&(e={});var n=new r.EndpointFactory;return new Promise(function(r,o){var s=n.getEndpointData(t);if(s){for(var i in e)s.endpoint=s.endpoint.replace("{{"+i+"}}",e[i]);r(s)}else o({error:"Unknown endPoint name."})})}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(7);e.$iq=r.$iq,e.$build=r.$build,e.$msg=r.$msg,e.$pres=r.$pres,e.Strophe=r.Strophe,e.NS=r.Strophe.NS,e.Status=r.Strophe.Status,window.Strophe=e.Strophe,window.$iq=e.$iq},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";e.__esModule=!0;var r=n(30),o=n(0),s=function(){function t(){}return t.transformPresence=function(t){return t.getAttribute("type")?new r.UserPresence(t.getAttribute(o.PresenceConstatnts.XMPP_KEYS.FROM),o.PresenceConstatnts.STATUS.OFFLINE,(new Date).getTime()):new r.UserPresence(t.getAttribute(o.PresenceConstatnts.XMPP_KEYS.FROM),o.PresenceConstatnts.STATUS.ONLINE,(new Date).getTime())},t.transformPresences=function(t){var e=[];return t.map(function(t){e.push(new r.UserPresence(t.getAttribute(o.PresenceConstatnts.XMPP_KEYS.FROM),t.getAttribute(o.PresenceConstatnts.XMPP_KEYS.STATUS),t.getAttribute(o.PresenceConstatnts.XMPP_KEYS.LAST_ACTIVE_AT)))}),e},t}();e.PresenceController=s},function(t,e,n){"use strict";e.__esModule=!0;var r=n(1),o=n(9),s=function(){function t(t,e,n,s){r.isFalsy(t)||(this.jid=t,this.uid=o.getUidFromJid(t),r.isFalsy(s)||(this.priority=s),r.isFalsy(e)||(this.status=e),r.isFalsy(n)||(this.lastActiveAt=n))}return t.prototype.getUid=function(){return this.uid},t.prototype.setUid=function(t){this.uid=t},t.prototype.getJid=function(){return this.jid},t.prototype.setJid=function(t){this.jid=t},t.prototype.getPriority=function(){return this.priority},t.prototype.setPriority=function(t){this.priority=t},t.prototype.getStatus=function(){return this.status},t.prototype.setStatus=function(t){this.status=t},t.prototype.getLastActiveAt=function(){return this.lastActiveAt},t.prototype.setLastActiveAt=function(t){this.lastActiveAt=t},t.prototype.getStatusMessage=function(){return this.statusMessage},t.prototype.setStatusMessage=function(t){this.statusMessage=t},t}();e.UserPresence=s},function(t,e,n){!function(t){"use strict";var e,n,r={}.hasOwnProperty,o=function(t,e){return function(){return t.apply(e,arguments)}};t.Strophe.addConnectionPlugin("muc",{_connection:null,rooms:{},roomNames:[],init:function(e){return this._connection=e,this._muc_handler=null,t.Strophe.addNamespace("MUC_OWNER",t.Strophe.NS.MUC+"#owner"),t.Strophe.addNamespace("MUC_ADMIN",t.Strophe.NS.MUC+"#admin"),t.Strophe.addNamespace("MUC_USER",t.Strophe.NS.MUC+"#user"),t.Strophe.addNamespace("MUC_ROOMCONF",t.Strophe.NS.MUC+"#roomconfig"),t.Strophe.addNamespace("MUC_REGISTER","jabber:iq:register")},join:function(e,r,o,s,i,a,u,c){var l,h,d;return h=this.test_append_nick(e,r),l=t.$pres({from:this._connection.jid,to:h}).c("x",{xmlns:t.Strophe.NS.MUC}),null!=u&&(l=l.c("history",u).up()),null!=a&&l.cnode(t.Strophe.xmlElement("password",[],a)),null!=c&&l.up().cnode(c),null==this._muc_handler&&(this._muc_handler=this._connection.addHandler((d=this,function(n){var r,o,s,i,a,u,c,l,h;if(!(r=n.getAttribute("from")))return!0;if(u=r.split("/")[0],!d.rooms[u])return!0;if(e=d.rooms[u],o={},"message"===n.nodeName)o=e._message_handlers;else if("presence"===n.nodeName&&(h=n.getElementsByTagName("x")).length>0)for(s=0,a=h.length;s<a;s++)if(c=h[s],(l=c.getAttribute("xmlns"))&&l.match(t.Strophe.NS.MUC)){o=e._presence_handlers;break}for(i in o)(0,o[i])(n,e)||delete o[i];return!0}))),this.rooms.hasOwnProperty(e)||(this.rooms[e]=new n(this,e,r,a),s&&this.rooms[e].addHandler("presence",s),o&&this.rooms[e].addHandler("message",o),i&&this.rooms[e].addHandler("roster",i),this.roomNames.push(e)),this._connection.send(l)},leave:function(e,n,r,o){var s,i,a,u;return s=this.roomNames.indexOf(e),delete this.rooms[e],s>=0&&(this.roomNames.splice(s,1),0===this.roomNames.length&&(this._connection.deleteHandler(this._muc_handler),this._muc_handler=null)),u=this.test_append_nick(e,n),a=this._connection.getUniqueId(),i=t.$pres({type:"unavailable",id:a,from:this._connection.jid,to:u}),null!=o&&i.c("status",o),null!=r&&this._connection.addHandler(r,null,"presence",null,a),this._connection.send(i),a},message:function(e,n,r,o,s,i){var a,u,c;return c=this.test_append_nick(e,n),s=s||(null!=n?"chat":"groupchat"),i=i||this._connection.getUniqueId(),(a=t.$msg({to:c,from:this._connection.jid,type:s,id:i}).c("body").t(r)).up(),null!=o&&(a.c("html",{xmlns:t.Strophe.NS.XHTML_IM}).c("body",{xmlns:t.Strophe.NS.XHTML}).h(o),0===a.node.childNodes.length?(u=a.node.parentNode,a.up().up(),a.node.removeChild(u)):a.up().up()),a.c("x",{xmlns:"jabber:x:event"}).c("composing"),this._connection.send(a),i},groupchat:function(t,e,n,r){return this.message(t,null,e,n,void 0,r)},invite:function(e,n,r){var o,s;return s=this._connection.getUniqueId(),o=t.$msg({from:this._connection.jid,to:e,id:s}).c("x",{xmlns:t.Strophe.NS.MUC_USER}).c("invite",{to:n}),null!=r&&o.c("reason",r),this._connection.send(o),s},multipleInvites:function(e,n,r){var o,s,i,a,u;for(a=this._connection.getUniqueId(),s=t.$msg({from:this._connection.jid,to:e,id:a}).c("x",{xmlns:t.Strophe.NS.MUC_USER}),o=0,i=n.length;o<i;o++)u=n[o],s.c("invite",{to:u}),null!=r&&(s.c("reason",r),s.up()),s.up();return this._connection.send(s),a},directInvite:function(e,n,r,o){var s,i,a;return a=this._connection.getUniqueId(),s={xmlns:"jabber:x:conference",jid:e},null!=r&&(s.reason=r),null!=o&&(s.password=o),i=t.$msg({from:this._connection.jid,to:n,id:a}).c("x",s),this._connection.send(i),a},queryOccupants:function(e,n,r){var o,s;return o={xmlns:t.Strophe.NS.DISCO_ITEMS},s=t.$iq({from:this._connection.jid,to:e,type:"get"}).c("query",o),this._connection.sendIQ(s,n,r)},configure:function(e,n,r){var o,s;return o=t.$iq({to:e,type:"get"}).c("query",{xmlns:t.Strophe.NS.MUC_OWNER}),s=o.tree(),this._connection.sendIQ(s,n,r)},cancelConfigure:function(e){var n,r;return n=t.$iq({to:e,type:"set"}).c("query",{xmlns:t.Strophe.NS.MUC_OWNER}).c("x",{xmlns:"jabber:x:data",type:"cancel"}),r=n.tree(),this._connection.sendIQ(r)},saveConfiguration:function(e,n,r,o){var s,i,a,u,c;if(a=t.$iq({to:e,type:"set"}).c("query",{xmlns:t.Strophe.NS.MUC_OWNER}),void 0!==t.Strophe.x&&void 0!==t.Strophe.x.Form&&n instanceof t.Strophe.x.Form)n.type="submit",a.cnode(n.toXML());else for(a.c("x",{xmlns:"jabber:x:data",type:"submit"}),i=0,u=n.length;i<u;i++)s=n[i],a.cnode(s).up();return c=a.tree(),this._connection.sendIQ(c,r,o)},createInstantRoom:function(e,n,r){var o;return o=t.$iq({to:e,type:"set"}).c("query",{xmlns:t.Strophe.NS.MUC_OWNER}).c("x",{xmlns:"jabber:x:data",type:"submit"}),this._connection.sendIQ(o.tree(),n,r)},createConfiguredRoom:function(e,n,o,s){var i,a,u;for(i in(a=t.$iq({to:e,type:"set"}).c("query",{xmlns:t.Strophe.NS.MUC_OWNER}).c("x",{xmlns:"jabber:x:data",type:"submit"})).c("field",{var:"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#roomconfig").up().up(),n)r.call(n,i)&&(u=n[i],a.c("field",{var:i}).c("value").t(u).up().up());return this._connection.sendIQ(a.tree(),o,s)},setTopic:function(e,n){var r;return r=t.$msg({to:e,from:this._connection.jid,type:"groupchat"}).c("subject",{xmlns:"jabber:client"}).t(n),this._connection.send(r.tree())},_modifyPrivilege:function(e,n,r,o,s){var i;return i=t.$iq({to:e,type:"set"}).c("query",{xmlns:t.Strophe.NS.MUC_ADMIN}).cnode(n.node),null!=r&&i.c("reason",r),this._connection.sendIQ(i.tree(),o,s)},modifyRole:function(e,n,r,o,s,i){var a;return a=t.$build("item",{nick:n,role:r}),this._modifyPrivilege(e,a,o,s,i)},kick:function(t,e,n,r,o){return this.modifyRole(t,e,"none",n,r,o)},voice:function(t,e,n,r,o){return this.modifyRole(t,e,"participant",n,r,o)},mute:function(t,e,n,r,o){return this.modifyRole(t,e,"visitor",n,r,o)},op:function(t,e,n,r,o){return this.modifyRole(t,e,"moderator",n,r,o)},deop:function(t,e,n,r,o){return this.modifyRole(t,e,"participant",n,r,o)},modifyAffiliation:function(e,n,r,o,s,i){var a;return a=t.$build("item",{jid:n,affiliation:r}),this._modifyPrivilege(e,a,o,s,i)},ban:function(t,e,n,r,o){return this.modifyAffiliation(t,e,"outcast",n,r,o)},member:function(t,e,n,r,o){return this.modifyAffiliation(t,e,"member",n,r,o)},revoke:function(t,e,n,r,o){return this.modifyAffiliation(t,e,"none",n,r,o)},owner:function(t,e,n,r,o){return this.modifyAffiliation(t,e,"owner",n,r,o)},admin:function(t,e,n,r,o){return this.modifyAffiliation(t,e,"admin",n,r,o)},changeNick:function(e,n){var r,o;return o=this.test_append_nick(e,n),r=t.$pres({from:this._connection.jid,to:o,id:this._connection.getUniqueId()}),this._connection.send(r.tree())},setStatus:function(e,n,r,o){var s,i;return i=this.test_append_nick(e,n),s=t.$pres({from:this._connection.jid,to:i}),null!=r&&s.c("show",r).up(),null!=o&&s.c("status",o),this._connection.send(s.tree())},registrationRequest:function(e,n,r){var o;return o=t.$iq({to:e,from:this._connection.jid,type:"get"}).c("query",{xmlns:t.Strophe.NS.MUC_REGISTER}),this._connection.sendIQ(o,function(t){var e,r,o,s,i,a;for((r=t.getElementsByTagName("field")).length,s={required:[],optional:[]},i=0,a=r.length;i<a;i++)e=r[i],o={var:e.getAttribute("var"),label:e.getAttribute("label"),type:e.getAttribute("type")},e.getElementsByTagName("required").length>0?s.required.push(o):s.optional.push(o);return n(s)},r)},submitRegistrationForm:function(e,n,r,o){var s,i,a;for(i in(s=t.$iq({to:e,type:"set"}).c("query",{xmlns:t.Strophe.NS.MUC_REGISTER})).c("x",{xmlns:"jabber:x:data",type:"submit"}),s.c("field",{var:"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#register").up().up(),n)a=n[i],s.c("field",{var:i}).c("value").t(a).up().up();return this._connection.sendIQ(s,r,o)},listRooms:function(e,n,r){var o;return o=t.$iq({to:e,from:this._connection.jid,type:"get"}).c("query",{xmlns:t.Strophe.NS.DISCO_ITEMS}),this._connection.sendIQ(o,n,r)},test_append_nick:function(e,n){var r,o;return o=t.Strophe.escapeNode(t.Strophe.getNodeFromJid(e)),r=t.Strophe.getDomainFromJid(e),o+"@"+r+(null!=n?"/"+n:"")}}),n=function(){function n(e,n,r,s){this.client=e,this.name=n,this.nick=r,this.password=s,this._roomRosterHandler=o(this._roomRosterHandler,this),this._addOccupant=o(this._addOccupant,this),this.roster={},this._message_handlers={},this._presence_handlers={},this._roster_handlers={},this._handler_ids=0,this.client.muc&&(this.client=this.client.muc),this.name=t.Strophe.getBareJidFromJid(this.name),this.addHandler("presence",this._roomRosterHandler)}return n.prototype.join=function(t,e,n){return this.client.join(this.name,this.nick,t,e,n,this.password)},n.prototype.leave=function(t,e){return this.client.leave(this.name,this.nick,t,e),delete this.client.rooms[this.name]},n.prototype.message=function(t,e,n,r){return this.client.message(this.name,t,e,n,r)},n.prototype.groupchat=function(t,e){return this.client.groupchat(this.name,t,e)},n.prototype.invite=function(t,e){return this.client.invite(this.name,t,e)},n.prototype.multipleInvites=function(t,e){return this.client.invite(this.name,t,e)},n.prototype.directInvite=function(t,e){return this.client.directInvite(this.name,t,e,this.password)},n.prototype.configure=function(t){return this.client.configure(this.name,t)},n.prototype.cancelConfigure=function(){return this.client.cancelConfigure(this.name)},n.prototype.saveConfiguration=function(t){return this.client.saveConfiguration(this.name,t)},n.prototype.queryOccupants=function(t,e){return this.client.queryOccupants(this.name,t,e)},n.prototype.setTopic=function(t){return this.client.setTopic(this.name,t)},n.prototype.modifyRole=function(t,e,n,r,o){return this.client.modifyRole(this.name,t,e,n,r,o)},n.prototype.kick=function(t,e,n,r){return this.client.kick(this.name,t,e,n,r)},n.prototype.voice=function(t,e,n,r){return this.client.voice(this.name,t,e,n,r)},n.prototype.mute=function(t,e,n,r){return this.client.mute(this.name,t,e,n,r)},n.prototype.op=function(t,e,n,r){return this.client.op(this.name,t,e,n,r)},n.prototype.deop=function(t,e,n,r){return this.client.deop(this.name,t,e,n,r)},n.prototype.modifyAffiliation=function(t,e,n,r,o){return this.client.modifyAffiliation(this.name,t,e,n,r,o)},n.prototype.ban=function(t,e,n,r){return this.client.ban(this.name,t,e,n,r)},n.prototype.member=function(t,e,n,r){return this.client.member(this.name,t,e,n,r)},n.prototype.revoke=function(t,e,n,r){return this.client.revoke(this.name,t,e,n,r)},n.prototype.owner=function(t,e,n,r){return this.client.owner(this.name,t,e,n,r)},n.prototype.admin=function(t,e,n,r){return this.client.admin(this.name,t,e,n,r)},n.prototype.changeNick=function(t){return this.nick=t,this.client.changeNick(this.name,nick)},n.prototype.setStatus=function(t,e){return this.client.setStatus(this.name,this.nick,t,e)},n.prototype.addHandler=function(t,e){var n;switch(n=this._handler_ids++,t){case"presence":this._presence_handlers[n]=e;break;case"message":this._message_handlers[n]=e;break;case"roster":this._roster_handlers[n]=e;break;default:return this._handler_ids--,null}return n},n.prototype.removeHandler=function(t){return delete this._presence_handlers[t],delete this._message_handlers[t],delete this._roster_handlers[t]},n.prototype._addOccupant=function(t){var n;return n=new e(t,this),this.roster[n.nick]=n,n},n.prototype._roomRosterHandler=function(t){var e,r,o,s,i;switch(e=n._parsePresence(t),s=e.nick,o=e.newnick||null,e.type){case"error":return!0;case"unavailable":o&&(e.nick=o,this.roster[s]&&this.roster[o]&&(this.roster[s].update(this.roster[o]),this.roster[o]=this.roster[s]),this.roster[s]&&!this.roster[o]&&(this.roster[o]=this.roster[s].update(e))),delete this.roster[s];break;default:this.roster[s]?this.roster[s].update(e):this._addOccupant(e)}for(r in i=this._roster_handlers)(0,i[r])(this.roster,this)||delete this._roster_handlers[r];return!0},n._parsePresence=function(e){var n,r,o,s,i,a,u,c,l,h;for((o={}).nick=t.Strophe.getResourceFromJid(e.getAttribute("from")),o.type=e.getAttribute("type"),o.states=[],c=e.childNodes,s=0,a=c.length;s<a;s++)switch((n=c[s]).nodeName){case"error":o.errorcode=n.getAttribute("code"),o.error=null!=(l=n.childNodes[0])?l.nodeName:void 0;break;case"status":o.status=n.textContent||null;break;case"show":o.show=n.textContent||null;break;case"x":if(n.getAttribute("xmlns")===t.Strophe.NS.MUC_USER)for(h=n.childNodes,i=0,u=h.length;i<u;i++)switch((r=h[i]).nodeName){case"item":o.affiliation=r.getAttribute("affiliation"),o.role=r.getAttribute("role"),o.jid=r.getAttribute("jid"),o.newnick=r.getAttribute("nick");break;case"status":r.getAttribute("code")&&o.states.push(r.getAttribute("code"))}}return o},n}(),function(){function t(t){this.parse=o(this.parse,this),null!=t&&this.parse(t)}t.prototype.parse=function(t){var e,n,r,o,s,i,a,u,c,l,h,d,p;for(d=t.getElementsByTagName("query")[0].childNodes,this.identities=[],this.features=[],this.x=[],s=0,c=d.length;s<c;s++)switch(r=d[s],n=r.attributes,r.nodeName){case"identity":for(i={},a=0,l=n.length;a<l;a++)e=n[a],i[e.name]=e.textContent;this.identities.push(i);break;case"feature":this.features.push(r.getAttribute("var"));break;case"x":if("FORM_TYPE"===!r.childNodes[0].getAttribute("var")||"hidden"===!r.childNodes[0].getAttribute("type"))break;for(p=r.childNodes,u=0,h=p.length;u<h;u++)(o=p[u]).attributes.type||this.x.push({var:o.getAttribute("var"),label:o.getAttribute("label")||"",value:o.firstChild.textContent||""})}return{identities:this.identities,features:this.features,x:this.x}}}(),e=function(){function t(t,e){this.room=e,this.update=o(this.update,this),this.admin=o(this.admin,this),this.owner=o(this.owner,this),this.revoke=o(this.revoke,this),this.member=o(this.member,this),this.ban=o(this.ban,this),this.modifyAffiliation=o(this.modifyAffiliation,this),this.deop=o(this.deop,this),this.op=o(this.op,this),this.mute=o(this.mute,this),this.voice=o(this.voice,this),this.kick=o(this.kick,this),this.modifyRole=o(this.modifyRole,this),this.update(t)}return t.prototype.modifyRole=function(t,e,n,r){return this.room.modifyRole(this.nick,t,e,n,r)},t.prototype.kick=function(t,e,n){return this.room.kick(this.nick,t,e,n)},t.prototype.voice=function(t,e,n){return this.room.voice(this.nick,t,e,n)},t.prototype.mute=function(t,e,n){return this.room.mute(this.nick,t,e,n)},t.prototype.op=function(t,e,n){return this.room.op(this.nick,t,e,n)},t.prototype.deop=function(t,e,n){return this.room.deop(this.nick,t,e,n)},t.prototype.modifyAffiliation=function(t,e,n,r){return this.room.modifyAffiliation(this.jid,t,e,n,r)},t.prototype.ban=function(t,e,n){return this.room.ban(this.jid,t,e,n)},t.prototype.member=function(t,e,n){return this.room.member(this.jid,t,e,n)},t.prototype.revoke=function(t,e,n){return this.room.revoke(this.jid,t,e,n)},t.prototype.owner=function(t,e,n){return this.room.owner(this.jid,t,e,n)},t.prototype.admin=function(t,e,n){return this.room.admin(this.jid,t,e,n)},t.prototype.update=function(t){return this.nick=t.nick||null,this.affiliation=t.affiliation||null,this.role=t.role||null,this.jid=t.jid||null,this.status=t.status||null,this.show=t.show||null,this},t}()}(n(7))},function(t,e,n){var r,o;r=[n(7)],void 0===(o=function(t){return function(t,e,n,r,o){var s=function(e,r,o){var s=n(r?{type:e,to:r}:{type:e});return s.c("vCard",{xmlns:t.NS.VCARD}),o&&s.cnode(o),s};t.addConnectionPlugin("vcard",{_connection:null,init:function(e){return this._connection=e,t.addNamespace("VCARD","vcard-temp")},get:function(t,e,n){var r=s("get",e);return this._connection.sendIQ(r,t,n)},set:function(t,e,n,r){var o=s("set",n,e);return this._connection.sendIQ(o,t,r)}})}(t.Strophe,t.$build,t.$iq,t.$msg,t.$pres),t}.apply(e,r))||(t.exports=o)},function(t,e,n){"use strict";e.__esModule=!0;var r=n(3),o=n(0),s=n(9),i=function(){function t(){}return t.transformVCard=function(t){var e={};return e[o.UserConstants.NAME]=unescape(s.parseHTML(t.getElementsByTagName(o.UserConstants.NAME)[0])),e[o.UserConstants.UID]=unescape(s.parseHTML(t.getElementsByTagName(o.UserConstants.UID)[0])),e[o.UserConstants.AVATAR]=unescape(s.parseHTML(t.getElementsByTagName(o.UserConstants.AVATAR)[0])),e[o.UserConstants.LINK]=unescape(s.parseHTML(t.getElementsByTagName(o.UserConstants.LINK)[0])),e[o.UserConstants.STATUS]=unescape(s.parseHTML(t.getElementsByTagName(o.UserConstants.STATUS)[0])),e[o.UserConstants.LAST_ACTIVE_AT]=unescape(s.parseHTML(t.getElementsByTagName(o.UserConstants.LAST_ACTIVE_AT)[0])),e[o.UserConstants.ROLE]=unescape(s.parseHTML(t.getElementsByTagName(o.UserConstants.ROLE)[0])),e[o.UserConstants.USER_NAME]=unescape(s.parseHTML(t.getElementsByTagName(o.UserConstants.USER_NAME)[0])),new r.AppUser(e)},t}();e.VCardController=i},function(t,e,n){"use strict";e.__esModule=!0;var r=n(0),o=n(6),s=n(1),i=n(2),a=function(){function t(t,e,n){this.XMPP_HOST="i.chatforyoursite.com",this.CALL_NO_ANSWER_INTERVAL=3e4,this.XMPP_MUC_HOST="%s.i.chatforyoursite.com",this.isCallSessionActive=!1,this.call=t,this.identity=e,this.service=n}return t.getInstance=function(e,n,r){return null!=this.callController&&null!=this.callController||(this.callController=new t(e,n,r)),this.callController},t.prototype.initiateCall=function(){this.startCallSession(),this.addPresenceListner()},t.prototype.getActiveCall=function(){return this.call},t.prototype.joinCallMuc=function(t){o.XMPPConnectionHelper.getInstance().connection.muc.join(s.format(r.XMPP.muc_jid_string,i.CometChat.getAppId(),t,i.CometChat.getAppId(),"call."+r.XMPP.host),o.XMPPConnectionHelper.getInstance().connection.jid)},t.prototype.leaveCallMuc=function(t){o.XMPPConnectionHelper.getInstance().connection.muc.leave(s.format(r.XMPP.muc_jid_string,i.CometChat.getAppId(),t,i.CometChat.getAppId(),"call."+r.XMPP.host),o.XMPPConnectionHelper.getInstance().connection.jid)},t.prototype.startCallSession=function(){this.joinCallMuc(this.identity)},t.prototype.endCallSession=function(){this.leaveCallMuc(this.identity),this.isCallSessionActive=!1,t.callController=null},t.prototype.startCall=function(t,e){var n=document.createElement("iframe");n.src="https://i.chatforyoursite.com/jitsi-meet/"+t,n.name="frame",n.setAttribute("allow","camera,microphone"),n.setAttribute("width","800"),n.setAttribute("height","800"),document.body.appendChild(n),window.addEventListener("message",function(t){"hangup"==t.data.type&&document.body.removeChild(n)})},t.prototype.addPresenceListner=function(){o.XMPPConnectionHelper.getInstance().connection.addHandler(function(t){return t.getElementsByTagName("x").length>0||console.log("Presence manager Main=>",{presence:t}),!0},null,"presence")},t}();e.CallController=a},function(t,e,n){"use strict";e.__esModule=!0;var r=n(4),o=n(13),s=n(1),i=n(10),a=n(0),u=function(){function t(e){this.fetchingInProgress=!1,this.limit=t.DEFAULT_LIMIT,this.cursorValue=0,this.cursorAffix=a.MessageConstatnts.PAGINATION.CURSOR_AFFIX_DEFAULT,this.cursorField=a.MessageConstatnts.PAGINATION.CURSOR_FIELD_DEFAULT,this.messageStore=i.MessagesStore.getInstance(),s.isFalsy(e)||(this.limit=e.limit,this.fromUID=e.fromUID,this.cursorField=e.cursorField,this.cursorValue=e.cursorValue)}return t.prototype.fetchPrevious=function(){var t=this;return new Promise(function(e,n){t.fetchingInProgress?(t.fetchingInProgress=!0,n([])):t.messageStore.get(t.fromUID).then(function(s){t.fetchingInProgress=!0;var i=[];s&&(i=Object.keys(s).filter(function(e){if(parseInt(s[e][t.cursorField])<t.cursorValue)return e}));var a=0,u=[];if(i.reverse().map(function(e){a++,console.log({i:a},t.cursorValue+":"+s[e][t.cursorField]),parseInt(t.cursorValue.toString())>=parseInt(s[e][t.cursorField])&&a<=t.limit&&(t.cursorValue=s[e][t.cursorField],u=u.concat([o.MessageController.trasformJSONMessge(s[e])]))}).length<t.limit){var c=[];return r.makeApiCall("getUserMessages",{uid:t.fromUID},t.createData()).then(function(n){n.data.length>0?(n.data.map(function(e){t.updateCursor(e[t.cursorField]),c.push(o.MessageController.trasformJSONMessge(e))}),t.messageStore.storeMessages(c),e(u.concat(c)),t.fetchingInProgress=!1):u.length>0?(e(u.slice()),t.fetchingInProgress=!1):(e([]),t.fetchingInProgress=!1)},function(e){n(e),t.fetchingInProgress=!1})}e(u),t.fetchingInProgress=!1})})},t.prototype.createData=function(){var t={};return t[a.MessageConstatnts.PAGINATION.KEYS.PER_PAGE]=this.limit,t[a.MessageConstatnts.PAGINATION.KEYS.CURSOR_AFFIX]=this.cursorAffix,t[a.MessageConstatnts.PAGINATION.KEYS.CURSOR_FIELD]=this.cursorField,t[a.MessageConstatnts.PAGINATION.KEYS.CURSOR_VALUE]=this.cursorValue,t},t.prototype.updateCursor=function(t){console.log("List of messages",{cursor:t}),(this.cursorValue>t||0==this.cursorValue)&&(this.cursorValue=t)},t.MAX_LIMIT=1,t.DEFAULT_LIMIT=1,t}();e.MessagesRequest=u;var c=function(){function t(t,e,n){this.cursorField=n,this.cursorValue=e,this.fromUID=t}return t.prototype.setLimit=function(t){return this.limit=t,this},t.prototype.setSearchKeyWord=function(t){return this.searchKeyWord=t,this},t.prototype.build=function(){return new u(this)},t}();e.MessagesRequestBuilder=c},function(t,e,n){"use strict";e.__esModule=!0;var r=n(4),o=n(1),s=n(5),i=n(22),a=function(){function t(e){this.limit=t.DEFAULT_LIMIT,this.cursor=-1,this.total=-1,this.next_page=1,this.last_page=-1,this.current_page=1,this.total_pages=-1,this.pagination={total:0,count:0,per_page:0,current_page:0,total_pages:0,links:[]},o.isFalsy(e)||(this.limit=e.limit,this.search_keyword=e.searchKeyWord)}return t.prototype.fetchPrevious=function(){var t=this;return new Promise(function(e,n){if(0!=t.next_page)return r.makeApiCall("groups",{},t.getPreData()).then(function(r){if(r.meta&&(t.total_pages=r.meta.pagination.total_pages),r.data.length>0){t.pagination=r.meta.pagination;var o=[];r.data.map(function(t,e){o.push(i.GroupsController.trasformJSONGroup(t))}),e(o)}n(new s.CustomError({}))});n("Error: no more Groups")})},t.prototype.fetchNext=function(){var t=this;return new Promise(function(e,n){r.makeApiCall("getGroups",{},t.getNextData()).then(function(n){if(n.meta&&(t.total_pages=n.meta.pagination.total_pages),n.data.length>0){t.pagination=n.meta.pagination;var r=[];n.data.map(function(t,e){r.push(i.GroupsController.trasformJSONGroup(t))}),e(r)}e([])},function(t){n(new s.CustomError(t))})})},t.prototype.getNextData=function(){var t={};if(t.per_page=this.limit,1==this.current_page)t.page=this.next_page,this.next_page++,this.current_page++;else{if(this.next_page>this.total_pages)return t.page=this.next_page,t;t.page=++this.next_page}return t},t.prototype.getPreData=function(){var t={};return t.per_page=this.limit,this.next_page>=0?(this.next_page>0&&(t.page=--this.next_page),t):t},t.MAX_LIMIT=2,t.DEFAULT_LIMIT=1,t}();e.GroupsRequest=a;var u=function(){function t(){}return t.prototype.setLimit=function(t){return this.limit=t,this},t.prototype.setSearchKeyWord=function(t){return this.searchKeyWord=t,this},t.prototype.build=function(){return new a(this)},t}();e.GroupsRequestBuilder=u},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0;var s=n(4),i=n(1),a=n(18),u=n(5),c=n(38),l=function(){function t(e){this.limit=t.DEFAULT_LIMIT,this.cursor=-1,this.total=-1,this.next_page=1,this.last_page=-1,this.current_page=1,this.total_pages=-1,this.isOutCastReq=!1,this.pagination={total:0,count:0,per_page:0,current_page:0,total_pages:0,links:[]},this.store=a.LocalStorage.getInstance(),i.isFalsy(e)||(this.limit=e.limit,this.guid=e.guid,this.search_keyword=e.searchKeyWord,e instanceof d&&(this.isOutCastReq=e.isOutCastReq))}return t.prototype.fetchPrevious=function(){var t=this;return new Promise(function(e,n){if(0!=t.next_page)return s.makeApiCall(t.isOutCastReq?"getBannedGroupMembers":"getGroupMembers",{guid:t.guid},t.getPreData()).then(function(n){if(n.meta&&(t.total_pages=n.meta.pagination.total_pages),n.data.length>0){t.pagination=n.meta.pagination;var r=[];n.data.map(function(t){r.push(c.GroupMembersController.trasformJSONGroupMember(t))}),e(r)}e([])},function(t){n(new u.CustomError(t))});n("Error: no mre users")})},t.prototype.fetchNext=function(){var t=this;return new Promise(function(e,n){console.log(),s.makeApiCall(t.isOutCastReq?"getBannedGroupMembers":"getGroupMembers",{guid:t.guid},t.getNextData()).then(function(n){if(n.meta&&(t.total_pages=n.meta.pagination.total_pages),n.data.length>0){t.pagination=n.meta.pagination;var r=[];n.data.map(function(t){r.push(c.GroupMembersController.trasformJSONGroupMember(t))}),e(r)}e([])},function(t){n(new u.CustomError(t))})})},t.prototype.getNextData=function(){var t={};if(t.per_page=this.limit,1==this.current_page)t.page=this.next_page,this.next_page++,this.current_page++;else{if(this.next_page>this.total_pages)return t.page=this.next_page,console.log({paginationData:t}),t;t.page=++this.next_page}return t},t.prototype.getPreData=function(){var t={};return t.per_page=this.limit,this.next_page>=0?(this.next_page>0&&(t.page=--this.next_page),t):(console.log({paginationData:t}),t)},t.MAX_LIMIT=2,t.DEFAULT_LIMIT=1,t}();e.GroupMembersRequest=l;var h=function(){function t(t){this.guid=t}return t.prototype.setLimit=function(t){return this.limit=t,this},t.prototype.setSearchKeyWord=function(t){return this.searchKeyWord=t,this},t.prototype.build=function(){return new l(this)},t}();e.GroupMembersRequestBuilder=h;var d=function(t){function e(e){var n=t.call(this,e)||this;return n.isOutCastReq=!0,n}return o(e,t),e.prototype.build=function(){return new l(this)},e}(h);e.GroupOutCastMembersRequestBuilder=d},function(t,e,n){"use strict";e.__esModule=!0;var r=n(39),o=n(3),s=n(0),i=function(){function t(){}return t.trasformJSONGroupMember=function(t){var e,n;try{e=new r.GroupMember(t[s.GroupMemersConstans.GUID],t[s.GroupMemersConstans.UID]),n=new o.AppUser({uid:t[s.GroupMemersConstans.UID]}),Object.assign(e,t),Object.assign(n,t[s.GroupMemersConstans.USER]),e.setUser(n),t=e}catch(e){console.log({groupMember:t,e:e})}return t},t}();e.GroupMembersController=i},function(t,e,n){"use strict";e.__esModule=!0;var r=n(0),o=function(){function t(t,e){this.isBanned=0,this.guid=t,this.uid=e}return t.prototype.setGuid=function(t){this.guid=t},t.prototype.setUid=function(t){this.uid=t},t.prototype.setScope=function(t){this.scope=t},t.prototype.setJoinedAt=function(t){this.joinedAt=t},t.prototype.setIsBanned=function(t){this.isBanned=t},t.prototype.setUser=function(t){this.user=t},t.prototype.getGuid=function(){return this.guid},t.prototype.getUid=function(){return this.uid},t.prototype.getuser=function(){return this.user},t.prototype.getScope=function(){return this.scope},t.prototype.getJoinedAt=function(){return this.joinedAt},t.prototype.getIsBanned=function(){return this.isBanned},t.GroupMemberScope=r.GroupMemberScope,t}();e.GroupMember=o}])});